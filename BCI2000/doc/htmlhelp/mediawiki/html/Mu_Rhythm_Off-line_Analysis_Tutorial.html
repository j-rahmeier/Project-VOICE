<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Mu Rhythm Off-line Analysis Tutorial - BCI2000 Help</title>
<link rel='shortcut icon' href='../../rsrc/favicon.ico' />
<style type='text/css'>
html { font-size:95%; font-family:arial,helvetica,sans-serif }
.printfooter { display:none }
#tocmain { font-size:81%; font-weight:bold; color:black; background-color:white; border:1px solid black; padding:1em; z-index:10; position:fixed; left:-1px; top:-1px; width:150px; }
#tocmain a { color:blue; text-decoration:none }
#tocmain ul { margin:0 0 0 0.4em; padding:0.1em 0 0 0.1em; list-style-position:outside; list-style-type:disc }
#tocmain li { text-indent:0; margin:0 0 0 1em; padding: 0 0 0 0 }
#tocmain p { margin:0; padding:0.1em 0 0 0.1em }
#tocmain .toc1 { margin-left:1.25em; }
#tocmain .toc2 { margin-left:2.25em; }
#tocmain .toc3 { margin-left:3.25em; }
#article { font-size:91%; position:absolute; left:200px; right:0; padding:1em; margin:0 }
</style>
</head>
<body>
 <div id='tocmain'>
 <a href='Main_Page.html'><img src='../../rsrc/bci2000logo.svg' alt='[Main Page]' /></a> <hr class="sep" /><p class="toc0"><a href="User_Tutorial%253ABCI2000_Tour.html">GettingStarted</a></p><ul></ul><p class="toc0"><a href="User_Reference%253AContents.html">User Manual</a></p><ul></ul><p class="toc0"><a href="Technical_Reference%253AContents.html">Technical Reference</a></p><ul></ul><p class="toc0"><a href="Programming_Reference%253AContents.html">Programming Manual</a></p><ul></ul><p class="toc0"><a href="Contributions%253AContents.html">Contributions</a></p><ul></ul><hr class="sep" /><p class="toc0"><a href="BCI2000_Glossary.html">BCI2000 Glossary</a></p> </div>
 <div id='article'>
 <h1 class = "pagetitle">Mu Rhythm Off-line Analysis Tutorial</h1>
 <p class = "subtitle"></p>
 <hr class = "sep" />
 <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Mu_Rhythm_Off-line_Analysis_Tutorial.html#Starting_an_Analysis_Session"><span class="tocnumber">1</span> <span class="toctext">Starting an Analysis Session</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Mu_Rhythm_Off-line_Analysis_Tutorial.html#Opening_Files_with_Mario"><span class="tocnumber">2</span> <span class="toctext">Opening Files with Mario</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="Mu_Rhythm_Off-line_Analysis_Tutorial.html#Selecting_Channels"><span class="tocnumber">3</span> <span class="toctext">Selecting Channels</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="Mu_Rhythm_Off-line_Analysis_Tutorial.html#Selecting_the_Spatial_Filter"><span class="tocnumber">4</span> <span class="toctext">Selecting the Spatial Filter</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="Mu_Rhythm_Off-line_Analysis_Tutorial.html#Feature_Extraction_Analysis"><span class="tocnumber">5</span> <span class="toctext">Feature Extraction Analysis</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="Mu_Rhythm_Off-line_Analysis_Tutorial.html#View_Results"><span class="tocnumber">6</span> <span class="toctext">View Results</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="Mu_Rhythm_Off-line_Analysis_Tutorial.html#R-square_Matrix"><span class="tocnumber">6.1</span> <span class="toctext">R-square Matrix</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="Mu_Rhythm_Off-line_Analysis_Tutorial.html#Power_Spectra_and_Topographic_Plots"><span class="tocnumber">6.2</span> <span class="toctext">Power Spectra and Topographic Plots</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="Mu_Rhythm_Off-line_Analysis_Tutorial.html#Interpretation_of_the_Results"><span class="tocnumber">6.3</span> <span class="toctext">Interpretation of the Results</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="Mu_Rhythm_Off-line_Analysis_Tutorial.html#Improving_the_Analysis"><span class="tocnumber">7</span> <span class="toctext">Improving the Analysis</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="Mu_Rhythm_Off-line_Analysis_Tutorial.html#Analyzing_the_Screening"><span class="tocnumber">8</span> <span class="toctext">Analyzing the Screening</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="Mu_Rhythm_Off-line_Analysis_Tutorial.html#Conclusions"><span class="tocnumber">9</span> <span class="toctext">Conclusions</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="Mu_Rhythm_Off-line_Analysis_Tutorial.html#Troubleshooting"><span class="tocnumber">10</span> <span class="toctext">Troubleshooting</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Starting_an_Analysis_Session">Starting an Analysis Session</span></h2>
<p>Every recording session has its own history. It is very difficult to say in advance what might happen during the recording. So we will assume that everything was perfect (the subject collaborated, no channel went lost, etc); later on we will consider the main causes of contamination, how to recognize it and what to do.
</p><p>If the recording session runs smoothly, you should now have in the folder <i>\TestData\Data\Mu</i>,   two files named <i>ALFAS006R01.dat</i> and <i>ALFAS006R02.dat</i>, corresponding to two of the eight runs usually recorded, respectively.
</p><p>Before you start the analysis you should locate the correct montage file on your hard disk. This is a file that describes the list of channels that were acquired. In this tutorial we will use <i>Complete_Montage(suggested choice).mmf</i>, which is located in the folder <i>\TestData\Montage</i>. If you need to edit the *.mmf file, check its data format.
</p>
<h2><span class="mw-headline" id="Opening_Files_with_Mario">Opening Files with Mario</span></h2>
<p>After having run mario.exe, press "Select Data Files".
</p><p><a href="https://www.bci2000.org/mediawiki/index.php/File:Mu_Rhy5.jpg" class="image"><img alt="Mu Rhy5.jpg" src="../images/0/06/Mu_Rhy5.jpg" decoding="async" width="437" height="578" /></a>
</p><p>A dialog window will ask you to select the dat files. You can either select a single data file, or select multiple files. This time, we will select all files in the dataset.
</p><p>A green box will surround the Raw Data box in the main window.
</p><p>As an optional (but recommended) operation, click on the LOAD MONTAGE button and choose the mmf file. This will allow you to see the labels of each channel and allow you to apply spatial filters that depend on the electrode position.
</p><p>You can load an additional parameters file with choices different from those used during the experiment.
</p><p>At this point, you can check that Mu is selected in the Analysis menu (indicating that a Mu dataset has been recognized) and click on the LOAD DATA button to confirm your choices. This will enable the EDIT CHANNEL LIST button that you can use to select the channels you want to include in your analysis.
</p>
<h2><span class="mw-headline" id="Selecting_Channels">Selecting Channels</span></h2>
<p>When you select the EDIT CHANNEL LIST button, two forms will show you the channel list (valid ones and not-valid ones) and an image showing valid channels and their location.
</p><p>Clicking on Add and Remove buttons allows you to move a channel from one list to the other, enabling or disabling it.
</p>
<h2><span class="mw-headline" id="Selecting_the_Spatial_Filter">Selecting the Spatial Filter</span></h2>
<p>Return to the main window, and you can choose which filter to apply for your analysis, selecting from the following filter choices:
</p>
<dl><dd><ul><li>RAW</li>
<li>CAR</li>
<li>Large Laplacian</li>
<li>Small Laplacian</li></ul></dd></dl>
<p>Common Average Reference (CAR) will be fine for most of the situations.
</p><p>We hope, soon, to release a user defined solution for any custom analysis.
</p>
<h2><span class="mw-headline" id="Feature_Extraction_Analysis">Feature Extraction Analysis</span></h2>
<p>The Analysis field in the Feature Extraction panel will appear automatically according to the files loaded, while the Feature Extractor field shows the only currently possible choice.
</p><p>You can view/edit analysis details by clicking on "Set Analysis Details" and "Set F.E. parameters"
</p><p>This second form reports all the settings for the parametric (autoregressive) spectral estimation stage. Most of the values are set after the corresponding values used on-line (see BCI2000 setup for Mu). Using the settings in the figure, the analysis software will:
</p>
<dl><dd><ul><li>analyze data recorded at 200 Hz sampling rate</li>
<li>remove the mean value</li>
<li>sample the spectrum at points starting from 0 Hz to 60 Hz, every 0.2 Hz.</li>
<li>Identify an auroregressive model of order 16</li>
<li>average these values into 2 Hz wide bins</li>
<li>take a 1 s long epoch of data</li></ul></dd></dl>
<p>You can modify these settings according to your aims. Changing the model order, for instance, brings sometimes to interesting results. Remember though that in the online version, spectral estimation is performed in epochs as short as 200 ms (i.e. 40 samples, at 200 Hz sampling rate), so you should avoid using a model order higher than half the samples available in the epoch.
When you are finished, remember to confirm your choices by slecting DONE. 
</p><p>In addition, a button in the Spectral Extimation frame allows you to revert to the original values. 
</p><p>Altogether you have to specify:
</p>
<dl><dd><ul><li>which data (in each trial) you want to take into account. Mu will only use the part of the trial when the cursor is visible, while MuExtended will take into account all the period when the target is visible. To learn more, see section D2Box Application States</li>
<li>If you have made an artifact rejection (or noted on the run sheet during the acquisition which trials contain artifacts), you can instruct the software not to use them</li>
<li>Finally, you must decide how the software must extract EEG epochs from the continuous data</li></ul></dd></dl>
<p>The epochs can be partially overlapped. This attenuates the data loss in case the length of a trial is not a multiple of the length of an epoch.
</p><p><br />
The percentage of overlap can be set both in Mario GUI and in any batch script. It is equal to the value of the <i>MU_params.overlapping</i> variable and the corresponding GUI field can be found by clickiing on <i>Set Analysis Details</i> on MARIO main form.
</p><p><br />
At this point you can start the analysis by clicking on the Evaluate and Plot button.
</p><p><a href="https://www.bci2000.org/mediawiki/index.php/File:Mu_Rhy8.jpg" class="image"><img alt="Mu Rhy8.jpg" src="../images/d/da/Mu_Rhy8.jpg" decoding="async" width="568" height="502" /></a>
</p>
<h2><span class="mw-headline" id="View_Results">View Results</span></h2>
<p>The first figure that appears is the R-square matrix (channels x frequency bins)
</p>
<h3><span class="mw-headline" id="R-square_Matrix">R-square Matrix</span></h3>
<p>The r-square matrix highlights the most relevant spectral features for the separation of the two classes of EEG - Cursor Up (target 1) and Cursor Down (target 2).
</p><p><a href="https://www.bci2000.org/mediawiki/index.php/File:Mu_Rhy8.jpg" class="image"><img alt="Mu Rhy8.jpg" src="../images/d/da/Mu_Rhy8.jpg" decoding="async" width="568" height="502" /></a>
</p><p>Each row of the matrix is related to a single channel, while a column represents a frequency bin (labeled with its central frequency). The color codes the statistical significance of the difference between the two kinds of evoked potentials.
</p><p>Thus a red color would mean that, on that channel and for that frequency, the "Up" EEG is significantly synchronized with respect to "Down" EEG.
</p><p>Clicking on a cell of the matrix will open two more windows:
</p>
<ul><li>Power spectral distribution of the selected channel</li>
<li>Topographic maps at the selected frequency.</li></ul>
<p>You can choose whether to overwrite or to put the most recently evoked figures beside the previous one. Two sets of waveform/topography figures are available, and are linked to the click of the left, the central or right mouse button.
<b>Left Button</b> will create/overwrite a first figure, <b>Right Button</b> will do the same on a second figure, the <b>Central Button</b> will always open a new plot.
</p>
<h3><span class="mw-headline" id="Power_Spectra_and_Topographic_Plots">Power Spectra and Topographic Plots</span></h3>
<p>In the lower panel you can find the spectral density of power for both classes of EEG. The Blue line refers to the "Up" condition, while the Red line refers to the "Down" condition.
We can see that at the vertex the "Down" condition is generally more synchronized than the "Up", with maximal difference in the beta band, consistently with what is shown by the R-square matrix.  The proportinality between spectral differences and R-square is anyway rough, since r-square is sensitive to the dispersion (variance) of single trials; thus, small differences between spectra could bring to a high r-square, if they were very reproducible.
</p><p>The peak around 50 Hz is due to mains disturbance; this also allows you to appreciate the leakage introduced by the spectral estimation.
</p><p><a href="https://www.bci2000.org/mediawiki/index.php/File:Mu_Rhy9.jpg" class="image"><img alt="Mu Rhy9.jpg" src="../images/e/ea/Mu_Rhy9.jpg" decoding="async" width="717" height="516" /></a>
</p><p>Over the spectral graph, a topographic plot shows the scalp distribution of the r-square.
</p><p>The color coding is the same as the r-square matrix figure, and values on each channel are interpolated to create a continuous bidimensional map. The higher the number of electrodes, the more accurate is the map. With Surface Laplacian spatial filtering, the number of channels shown on the scalp may not coincide with the whole number of electrodes, since the value of the laplacian is not computed on the border channels.
</p>
<h3><span class="mw-headline" id="Interpretation_of_the_Results">Interpretation of the Results</span></h3>
<p>The first step in the preliminary analysis of P300 BCI data is to find the absolute maximum of r-square. This simple statement must be mediated with a proper knowledge of physiological phenomena. In fact, we do not expect any sensorimotor activity at 3 Hz, so if the absolute maximum is at that frequency, you must suspect that it is actually an artifact. The same holds true if the spatial localization of the peak is far away from the centro-parietal electrodes.
</p><p>From a practical point of view, it is not important, now, to understand the reasons that different components explain the desynchronization peak on Cz at 17 Hz, so long as we are confident that this component is stable enough to be exploitable during the next session to control the cursor.
</p><p>The absolute value of R-square is mathematically bound to lie in the interval between 0 and 1. Values above 0.4 allow a rate of missed target on the order of a few percent. Values around 0.1 are promising. Values below 0.03 are possibly due to random fluctuations. All the previous figures refer to analyses made on 240 trials.
<i><b>Beware of artifacts!</b></i>
</p><p>During the acquisition, you should be particularly careful to avoid artifacts. While EOG and blink artifacts are confined to very low frequencies, EMG artifacts are mostly on the beta band and could largely overlap with the frequency band that characterizes the mu rhythm.
</p><p>If contaminated data was acquired, then you have two problems:
</p>
<dl><dd><ul><li>Realize that EMG is superimposed on the to data</li>
<li>Distinguish between spectral modulation introduced by EEG and by EMG</li></ul></dd></dl>
<p>The first task is not as trivial as it might appear. If you did not acquire the data yourself (or even if you did) you might complete the analysis procedure without giving a single glance to the raw data. So you must be particularly careful when you analyze the R-square maps, and always check if the peak you are seeing might be due to an artifact.
</p><p>Discriminant features between EEG and EMG are both in the frequency distribution and in the spatial distribution.
</p><p>EMG that strongly affects the recordings is mostly generated by muscles at the forehead or close to the ears/jaws. Thus, their spatial distribution is such that the most responsive channel is one of those at the border of the montage. Of course, due to volume conduction, the effects can be seen even on electrodes on the opposite part of the montage, but they show a degrading pattern.
On the other hand, a peak that shows its maximum on a central channel, can hardly be generated by a muscle or by other non-cephalic source.
</p><p>The spectrum of EEG is mainly concentrated in the alpha band, with a possible flatter and lower peak in beta. With the exception of the beta peak/plateau, the EEG spectrum decreases almost linearly (if measured in dB) after 12 Hz.
On the other hand, the EMG spectrum becomes significant at about 20 Hz and is still very high at the highest frequencies we usually analyze (60 Hz). A spectrum with a pattern more similar to the latter, may indicate that non-EEG activity is present in the data.
</p>
<h2><span class="mw-headline" id="Improving_the_Analysis">Improving the Analysis</span></h2>
<p>The first cause of an unsuccessful analysis is poor quality of the recording. For this reason it is highly recommended that, at least for the first experiments, the subject be highly motivated and cooperative. If this is the case, data of low quality are usually present in one or a few runs. And if the experimenter is careful enough, he/she should have noted the occurrence of strong artifacts on the run sheet.
In this case, the next step is to repeat an unsatisfactory data analysis after having excluded the (putative) bad runs.
To do this, just go back to the file selection dialog, choose LOAD Data again and load only the runs that you believe are clean. The number of runs should not be too low (as a rule of thumb, the data set should contain at least 100 trials), otherwise the r-square statistical analysis would loose sensitivity.
</p>
<h2><span class="mw-headline" id="Analyzing_the_Screening">Analyzing the Screening</span></h2>
<p>The screening experiment is not different from a regular training session, from the point of view of data format. You will have four sets (horizontal movement, horizontal imagination, vertical movement, and vertical imagination) of three runs, containing EEG acquired in two conditions (up and down, or left and right).
</p><p>Start analyzing the vertical movement execution, and mark a few possible responsive features. The analysis on the vertical movement imagination should confirm (though with a lower R-square) those that are actually related to sensorimotor cognitive states.
</p><p>In the case that no reliable responsive EEG feature is found, the analysis can be repeated on the horizontal dataset.
</p><p>If both the vertical and horizontal dataset show responsive features, and these are different, the subject should be trained for several sessions on vertical training until he/she decreases the error rate below 10%. At that point, the training of the horizontal modulation can begin, with the aim that, the subject will eventually control both the vertical and the horizontal simultaneously in a two-dimensional task.
</p>
<h2><span class="mw-headline" id="Conclusions">Conclusions</span></h2>
<p>If you are confident that you have found a significant difference between conditions that is due to EEG rather than an artifact, and that reflects a cognitive process that is likely to be reproduced (or even enhanced with training) in the next session, you have reached your goal.
The next time the same subject practices with the D2Box Application, you will have to change the MUD matrix so that it reflects the feature that you just outlined.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<p>Some OpenGL drivers may sometimes show defective figures like the following:
</p><p><a href="https://www.bci2000.org/mediawiki/index.php/File:Defective.jpg" class="image"><img alt="Defective.jpg" src="../images/0/04/Defective.jpg" decoding="async" width="560" height="420" /></a>
</p><p>Matlab customers can get around this problem using this simple procedure:
</p>
<dl><dd><ul><li>Select the defective figure window</li>
<li>Go to the Matlab Command Window</li>
<li>Execute one of the following command line:
<ul><li>set(gcf, 'Renderer', 'Painters')</li>
<li>set(gcf, 'Renderer', 'zbuffer')</li></ul></li></ul></dd></dl>
<p>The figure will be a plot using a different renderer (Painters or zBuffer).
</p>
<!-- 
NewPP limit report
Cached time: 20230523221902
Cache expiry: 86400
Dynamic content: false
Complications: []
CPU time usage: 0.034 seconds
Real time usage: 0.040 seconds
Preprocessor visited node count: 42/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key wikidb-bci_:pcache:idhash:1397-0!canonical and timestamp 20230523221902 and revision id 6098
 -->
</div></div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://www.bci2000.org/mediawiki/index.php?title=Mu_Rhythm_Off-line_Analysis_Tutorial&amp;oldid=6098">http://www.bci2000.org/mediawiki/index.php?title=Mu_Rhythm_Off-line_Analysis_Tutorial&amp;oldid=6098</a>"</div>
 </div>
</body>
</html>