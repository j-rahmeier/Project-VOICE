<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Contributions:BCI2000Unity - BCI2000 Help</title>
<link rel='shortcut icon' href='../../rsrc/favicon.ico' />
<style type='text/css'>
html { font-size:95%; font-family:arial,helvetica,sans-serif }
.printfooter { display:none }
#tocmain { font-size:81%; font-weight:bold; color:black; background-color:white; border:1px solid black; padding:1em; z-index:10; position:fixed; left:-1px; top:-1px; width:150px; }
#tocmain a { color:blue; text-decoration:none }
#tocmain ul { margin:0 0 0 0.4em; padding:0.1em 0 0 0.1em; list-style-position:outside; list-style-type:disc }
#tocmain li { text-indent:0; margin:0 0 0 1em; padding: 0 0 0 0 }
#tocmain p { margin:0; padding:0.1em 0 0 0.1em }
#tocmain .toc1 { margin-left:1.25em; }
#tocmain .toc2 { margin-left:2.25em; }
#tocmain .toc3 { margin-left:3.25em; }
#article { font-size:91%; position:absolute; left:200px; right:0; padding:1em; margin:0 }
</style>
</head>
<body>
 <div id='tocmain'>
 <a href='Main_Page.html'><img src='../../rsrc/bci2000logo.svg' alt='[Main Page]' /></a> <hr class="sep" /><p class="toc0"><a href="User_Tutorial%253ABCI2000_Tour.html">GettingStarted</a></p><ul></ul><p class="toc0"><a href="User_Reference%253AContents.html">User Manual</a></p><ul></ul><p class="toc0"><a href="Technical_Reference%253AContents.html">Technical Reference</a></p><ul></ul><p class="toc0"><a href="Programming_Reference%253AContents.html">Programming Manual</a></p><ul></ul><p class="toc0"><a href="Contributions%253AContents.html">Contributions</a></p><ul><li class="toc1"><a href="Contributions%253AADCs.html">Data Acquisition</a></li><li class="toc1"><a href="Contributions%253AFileWriters.html">File Formats</a></li><li class="toc1"><a href="Contributions%253ASignalProcessing.html">Signal Processing</a></li><li class="toc1"><a href="Contributions%253AApplications.html">Applications</a></li><li class="toc1"><a href="Contributions%253ATools.html">Tools</a></li></ul><hr class="sep" /><p class="toc0"><a href="BCI2000_Glossary.html">BCI2000 Glossary</a></p> </div>
 <div id='article'>
 <h1 class = "pagetitle">BCI2000Unity</h1>
 <p class = "subtitle">Contributions</p>
 <hr class = "sep" />
 <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Contributions%253ABCI2000Unity.html#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Contributions%253ABCI2000Unity.html#Prerequisites"><span class="tocnumber">2</span> <span class="toctext">Prerequisites</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="Contributions%253ABCI2000Unity.html#Usage"><span class="tocnumber">3</span> <span class="toctext">Usage</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="Contributions%253ABCI2000Unity.html#Using_built-in_variables"><span class="tocnumber">3.1</span> <span class="toctext">Using built-in variables</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="Contributions%253ABCI2000Unity.html#Adding_custom_variables"><span class="tocnumber">3.2</span> <span class="toctext">Adding custom variables</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="Contributions%253ABCI2000Unity.html#Custom_Variables"><span class="tocnumber">3.3</span> <span class="toctext">Custom Variables</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="Contributions%253ABCI2000Unity.html#Custom_Variable_Class_Example"><span class="tocnumber">3.4</span> <span class="toctext">Custom Variable Class Example</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="Contributions%253ABCI2000Unity.html#Number_Formats"><span class="tocnumber">3.5</span> <span class="toctext">Number Formats</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="Contributions%253ABCI2000Unity.html#Other_scripting"><span class="tocnumber">3.6</span> <span class="toctext">Other scripting</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="Contributions%253ABCI2000Unity.html#Properties"><span class="tocnumber">4</span> <span class="toctext">Properties</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="Contributions%253ABCI2000Unity.html#UnityBCI2000"><span class="tocnumber">4.1</span> <span class="toctext">UnityBCI2000</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="Contributions%253ABCI2000Unity.html#BCI2000StateSender"><span class="tocnumber">4.2</span> <span class="toctext">BCI2000StateSender</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="Contributions%253ABCI2000Unity.html#Other_Notes"><span class="tocnumber">5</span> <span class="toctext">Other Notes</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>Unity is a cross-platform game engine with support for desktop, mobile, console, and virtual reality platforms. It is both easy for beginners to use and is popular for low-cost game development. This is a Unity package which integrates BCI2000.
</p>
<h2><span class="mw-headline" id="Prerequisites">Prerequisites</span></h2>
<p>UnityBCI2000 depends on the BCI2000RemoteNET library, located at
<a rel="nofollow" class="external text" href="https://github.com/neurotechcenter/BCI2000RemoteNET">Github</a> or <a rel="nofollow" class="external text" href="https://www.nuget.org/packages/BCI2000RemoteNET">NuGet</a>).
Keep in mind that at the moment both BCI2000RemoteNET and BCI2000Unity are not fully released, and are still in development, so features and API structure are subject to change at any time, and bugs are to be expected.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<p>Add the `UnityBCI2000.cs` script to one `GameObject`. This is the central script which communicates with BCI2000.  
Add the `BCI2000StateSender` to any object which you want to monitor with BCI2000.  
Before starting, you must set the operator and modules to start up, by specifying the fields
`OperatorPath` and `Module[1-3]`. All other properties have default settings and will function without change.  
Alternatively, if you leave `OperatorPath` blank, `BCI2000Remote` will attempt to connect to an operator at
`TelnetIp:TelnetPort`. This is useful for if you already have an operator open that you want to use.  
If you also have modules started within a running BCI2000 instance, set `DontStartModules` to `true`, this will preserve
your running modules.
</p>
<h3><span class="mw-headline" id="Using_built-in_variables">Using built-in variables</span></h3>
<p>`BCI2000StateSender` has some variables built in. To use these, just select their check boxes in the inspector.
</p>
<h3><span class="mw-headline" id="Adding_custom_variables">Adding custom variables</span></h3>
<p>To add custom variables,  add a script to the same object as a `BCI2000StateSender`, which inherits from `CustomVariableBase`.  
Then, add the `CustomVariableBase` to the "Custom Variable Supplier" field of the `BCI2000StateSender`.
Then, add `CustomVariable`s to the list `customVariables` within the `CustomVariableBase`. There are some included
templates and snippets which show the syntax for adding custom variables.
</p>
<h3><span class="mw-headline" id="Custom_Variables">Custom Variables</span></h3>
<p>A custom variable has four fields. These are its name, value, scale, and type.  
Its name is a string which holds its name.  
Its value is a `Func&lt;float&gt;` delegate which returns a float, which will be sent to BCI2000, after being multiplied by its scale.  
Its type is a member of the enum `UnityBCI2000.StateType`, which represents the format of the number being sent to BCI2000.
</p>
<h3><span class="mw-headline" id="Custom_Variable_Class_Example">Custom Variable Class Example</span></h3>
<p>Template
</p>
<pre>   public class &lt;ClassName&gt;&#160;: CustomVariableBase
   {
       public override void AddCustomVariables()
       {
           customVariables.Add(new CustomSetVariable(  //Copy this for more set variables
               "[Name]",
               new Func&lt;float&gt;(() =&gt; [Code which returns variable to send]),
               [Scale],
               UnityBCI2000.StateType.[Type]
               ));
               
           customVariables.Add(new CustomGetVariable(  //Copy this for more get variables
               "[Name]",  
               new Action&lt;int&gt; ((int i) =&gt; [Code which uses i])
           ));
</pre>
<pre>       }
   }
</pre>
<p>Example
</p>
<pre>   public class CustomVariableSupplier1&#160;: CustomVariableBase
   {
       public override void AddCustomVariables() 
       {
           customVariables.Add(new CustomSetVariable(
               "Custom variable 1",
               new Func&lt;float&gt;(() =&gt; {return 65 / 5;}),
               100,
               UnityBCI2000.StateType.SignedInt16
               ));
           customVariables.Add(new CustomSetVariable(
               "Custom variable 2: Frame count",
               new Func&lt;float&gt;(() =&gt; Time.frameCount),
               1,
               UnityBCI2000.StateType.UnsignedInt32
               ));
           customVariables.Add(new CustomGetVariable(  
               "StateName",  
               new Action&lt;int&gt; ((int i) =&gt; {score = i})
           ));
       }
   }
</pre>
<h3><span class="mw-headline" id="Number_Formats">Number Formats</span></h3>
<p>The available formats are found in the enum `UnityBCI2000.StateType`. As they are being accessed outside of `UnityBCI2000`, 
they will always be preceded by "UnityBCI2000.".
</p><p>The formats are `Boolean`, `UnsignedInt16`, `UnsignedInt32`, `SignedInt16`, and `SignedInt32`.  
These are available formats because BCI2000 takes state values in the form of unsigned integers with a bit width of powers of 2 between 1 and 32.  
Boolean is the same as an unsigned int of bit width 1.  
Signed numbers will generate a second state within BCI2000 of bit width 1, which holds their sign. If they are negative, their sign will be 1,
and if they are positive, their sign will be 0. Use signed numbers if your value will ever be negative.
</p>
<h3><span class="mw-headline" id="Other_scripting">Other scripting</span></h3>
<p>Try to avoid calling any of the methods directly. UnityBCI2000 should ideally be able to run and control BCI2000 without any intervention.
</p>
<h2><span class="mw-headline" id="Properties">Properties</span></h2>
<h3><span class="mw-headline" id="UnityBCI2000">UnityBCI2000</span></h3>
<p>`Timeout`
The timeout, in milliseconds, for sending and receiving commands, default 1000.
</p><p>`TelnetIP`
The IP at which to connect to the Operator, default 127.0.0.1
Note: Don't use "localhost" when setting this, as this causes errors due to ambiguity in name resolution.
</p><p>`TelnetPort`
The port to connect to the Operator, default 3999.
</p><p>`OperatorPath`
The path to the Operator module to start up when there is no running operator at the IP and port specified, will always connect on localhost, at the previously given port.
</p><p>`LogFile`
The path to the file to write the log. This is overwritten on `Connect()`, default "logFile.txt", in the application's working directory.
</p><p>`LogStates`
Whether or not to log commands to set a state, as well as the received Prompt if the command produces no errors, default false.
</p><p>`LogPrompts`
Whether or not to log any Prompt, in which case only received output and errors will be logged, default false.
</p>
<h3><span class="mw-headline" id="BCI2000StateSender">BCI2000StateSender</span></h3>
<p>`UnityBCI2000 object`
The object which has the attached `UnityBCI2000` script.
</p><p>`Custom Variable Supplier`
The component which inherits from `CustomVariableBase` which supplies custom variables.
</p><p>Global and screen coordinates and their scales.
</p><p>`Camera`
The camera to use for finding screen position.
</p><p>`Is on screen`
Is the object on screen.
</p><p><br />
`Velocity`
The velocity of the object in any direction.
</p><p>`Custom Variables`
Lists the names of any added custom variables.
</p>
<h2><span class="mw-headline" id="Other_Notes">Other Notes</span></h2>
<p>`StateVariable` is a class which holds values necessary for sending states to BCI2000.  
They are stored in two places, a central list within `UnityBCI2000` which is only used for checking if a state already exists,
and within the `BCI2000StateSender` which 'owns' the state, where they are stored within objects called `SendStateVariable`,
which update the state with a new value every frame. This is done so that one state can be changed by mutiple `BCI2000StateSender`s,
through the use of multiple `SendStateVariables` created using the `AddSendExistingState()` method. 
</p><p>BCI2000Remote will write its output to a log file that is, by default, located at logFile.txt in the working directory of your Unity application.
</p>
<!-- 
NewPP limit report
Cached time: 20230524175444
Cache expiry: 86400
Dynamic content: false
Complications: []
CPU time usage: 0.014 seconds
Real time usage: 0.016 seconds
Preprocessor visited node count: 38/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key wikidb-bci_:pcache:idhash:2368-0!canonical and timestamp 20230524175444 and revision id 9209
 -->
</div></div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://www.bci2000.org/mediawiki/index.php?title=Contributions:BCI2000Unity&amp;oldid=9209">http://www.bci2000.org/mediawiki/index.php?title=Contributions:BCI2000Unity&amp;oldid=9209</a>"</div>
 </div>
</body>
</html>