<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Programming Reference:Localization - BCI2000 Help</title>
<link rel='shortcut icon' href='../../rsrc/favicon.ico' />
<style type='text/css'>
html { font-size:95%; font-family:arial,helvetica,sans-serif }
.printfooter { display:none }
#tocmain { font-size:81%; font-weight:bold; color:black; background-color:white; border:1px solid black; padding:1em; z-index:10; position:fixed; left:-1px; top:-1px; width:150px; }
#tocmain a { color:blue; text-decoration:none }
#tocmain ul { margin:0 0 0 0.4em; padding:0.1em 0 0 0.1em; list-style-position:outside; list-style-type:disc }
#tocmain li { text-indent:0; margin:0 0 0 1em; padding: 0 0 0 0 }
#tocmain p { margin:0; padding:0.1em 0 0 0.1em }
#tocmain .toc1 { margin-left:1.25em; }
#tocmain .toc2 { margin-left:2.25em; }
#tocmain .toc3 { margin-left:3.25em; }
#article { font-size:91%; position:absolute; left:200px; right:0; padding:1em; margin:0 }
</style>
</head>
<body>
 <div id='tocmain'>
 <a href='Main_Page.html'><img src='../../rsrc/bci2000logo.svg' alt='[Main Page]' /></a> <hr class="sep" /><p class="toc0"><a href="User_Tutorial%253ABCI2000_Tour.html">GettingStarted</a></p><ul></ul><p class="toc0"><a href="User_Reference%253AContents.html">User Manual</a></p><ul></ul><p class="toc0"><a href="Technical_Reference%253AContents.html">Technical Reference</a></p><ul></ul><p class="toc0"><a href="Programming_Reference%253AContents.html">Programming Manual</a></p><ul><li class="toc1">Concepts</li><ul><li class="toc2"><a href="Programming_Reference%253AFilter_Chain.html">Filter Chain</a></li><li class="toc2"><a href="Programming_Reference%253ASignals.html">Signals</a></li><li class="toc2"><a href="Programming_Reference%253AError_Handling.html">Error Handling</a></li><li class="toc2">Localization</li><li class="toc2"><a href="Programming_Reference%253ARapid_Development.html">Rapid Development</a></li></ul><li class="toc1">Reference</li><ul><li class="toc2"><a href="Programming_Reference%253AGenericFilter_Class.html">GenericFilter</a></li><li class="toc2"><a href="Programming_Reference%253AEnvironment_Class.html">Environment</a></li><li class="toc2"><a href="Programming_Reference%253AGenericVisualization_Class.html">GenericVisualization</a></li><li class="toc2"><a href="Programming_Reference%253AErrors_and_Warnings.html">Errors and Warnings</a></li><li class="toc2"><a href="Programming_Reference%253ADebug_Output.html">Debug Output</a></li></ul><li class="toc1">Data Acquisition</li><ul><li class="toc2"><a href="Programming_Reference%253AGenericADC_Class.html">GenericADC</a></li></ul><li class="toc1">Data Storage</li><ul><li class="toc2"><a href="Programming_Reference%253AGenericFileWriter_Class.html">GenericFileWriter</a></li><li class="toc2"><a href="Programming_Reference%253ABCI2000FileReader_Class.html">BCI2000FileReader</a></li></ul><li class="toc1">Signal Processing</li><ul><li class="toc2"><a href="Programming_Reference%253AIIRFilterBase_Class.html">IIR Filters</a></li></ul><li class="toc1">Application Modules</li><ul><li class="toc2"><a href="Programming_Reference%253AApplicationBase_Class.html">ApplicationBase</a></li><li class="toc2"><a href="Programming_Reference%253AFeedbackTask_Class.html">FeedbackTask</a></li><li class="toc2"><a href="Programming_Reference%253AStimulusTask_Class.html">StimulusTask</a></li><li class="toc2"><a href="Programming_Reference%253A3D_API.html">3D API</a></li></ul><li class="toc1">Howtos</li><ul><li class="toc2"><a href="Programming_Howto%253ABuilding_BCI2000.html">Building BCI2000</a></li><li class="toc2"><a href="Programming_Howto%253ASVN_Client_Setup.html">SVN Client Setup</a></li><li class="toc2"><a href="Programming_Howto%253AUsing_TortoiseSVN.html">Using TortoiseSVN</a></li></ul><li class="toc1"><a href="Programming_FAQ.html">FAQ</a></li><li class="toc1">Tutorials</li><ul><li class="toc2"><a href="Programming_Tutorial%253AImplementing_a_Data_Acquisition_Module.html">Data Acquisition</a></li><li class="toc2"><a href="Programming_Tutorial%253AImplementing_a_Signal_Processing_Filter.html">Signal Processing</a></li><li class="toc2"><a href="Programming_Tutorial%253AImplementing_a_Matlab-based_Filter.html">Matlab Signal Processing</a></li></ul></ul><p class="toc0"><a href="Contributions%253AContents.html">Contributions</a></p><ul></ul><hr class="sep" /><p class="toc0"><a href="BCI2000_Glossary.html">BCI2000 Glossary</a></p> </div>
 <div id='article'>
 <h1 class = "pagetitle">Localization</h1>
 <p class = "subtitle">Programming Reference</p>
 <hr class = "sep" />
 <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Programming_Reference%253ALocalization.html#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Programming_Reference%253ALocalization.html#Strategies"><span class="tocnumber">2</span> <span class="toctext">Strategies</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="Programming_Reference%253ALocalization.html#Implementation"><span class="tocnumber">3</span> <span class="toctext">Implementation</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="Programming_Reference%253ALocalization.html#Interface_to_the_operator_user"><span class="tocnumber">3.1</span> <span class="toctext">Interface to the operator user</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="Programming_Reference%253ALocalization.html#Interface_to_the_programmer"><span class="tocnumber">3.2</span> <span class="toctext">Interface to the programmer</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="Programming_Reference%253ALocalization.html#Further_implementation_details"><span class="tocnumber">3.3</span> <span class="toctext">Further implementation details</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>As BCI2000 modules are being used in various countries, there emerges some need to adapt user interface elements to regional customs. Most notably, text that gives information to the subject requires translation into the subject's native language, as often a knowledge of English cannot be assumed. Even with a knowledge of English, reading text in a foreign language is a distracting factor that makes the already demanding task of operating a BCI even more difficult.
</p><p>This document explains the approach taken to manage localized (translated) user interface strings in BCI2000 application modules, trying to meet the following goals:
</p>
<ul><li><b>Flexibility:</b>  For the end user (operator), it should be possible to add translations into a additional languages, and to modify translations he does not feel to be appropriate. This should be achievable without making changes to the source code and recompiling the application module.</li>
<li><b>Separability:</b>  For the user, switching languages should be done at a central place, i.e., by changing a single parameter. For the programmer, adding localization capabilities to existing modules should be possible with minimal changes to existing code. When writing new application modules, there should be no need to consider localization issues in advance.</li>
<li><b>Documentation:</b> Documenting and providing a collection of existing translations into various languages should be possible inside a module's source code.</li></ul>
<p><br />
</p>
<h2><span class="mw-headline" id="Strategies">Strategies</span></h2>
<p>For a number of text values that have always been set from parameters (such as the Speller module's <tt>TextToSpell</tt> parameter that holds the text the user is told to spell in copy spelling mode), localization is not an issue because the user may just change the value as seems appropriate.
</p><p>The remaining text items, according to the way they are specified, fall into two categories:
</p>
<ol><li>C string literals in <tt>*.cpp</tt> source files, and</li>
<li>text fields in GUI resource files (such as Borland <tt>*.dfm</tt> files).</li></ol>
<p>For both categories, translations are kept in a single matrix type parameter that uses string labels, i.e., row and column titles. Each column title represents the native English version of a text; row titles represent languages for which translations exist. The user chooses amongst languages by specifying the desired language in a second parameter; the BCI2000 framework will then use this table to look up a text's translation, matching the text itself against column labels, and 
the target language against row labels. If no match is found, it will leave the text unchanged.
</p><p>For string literals in <tt>*.cpp</tt> files, the strategy is to simply put a function layer around the string, i.e., to send it through a function that checks for a translation and exchanges the text if there is a match. Introducing localizability into existing code implies only a very small amount of change compared to, e.g., introducing a separate parameter for each string. In the former case, one needs only wrap the string literal into a function call in-place; in the latter case, one would have to add a parameter line to a possibly remote filter class constructor, read that parameter from inside that filter's <tt>Initialize()</tt> call, and put it into the object that actually holds the string which might require introduction of additional accessor functions.
</p><p>For strings specified in GUI resource files, the strategy is to supply a function that, very generally, examines string properties of GUI objects, replacing them with their localized versions if applicable.
This function needs to be called explicitly from inside the <tt>Initialize()</tt> function of the <tt>GenericFilter</tt> descendant that determines the GUI object's behavior (in most cases, this is the application module's <tt>TTask</tt> class).
</p><p><br /> 
</p>
<h2><span class="mw-headline" id="Implementation">Implementation</span></h2>
<p>The implementation is centered around a <tt>Localization</tt> class declared in <tt>Application/shared/Localization.h</tt>.
</p>
<h3><span class="mw-headline" id="Interface_to_the_operator_user">Interface to the operator user</span></h3>
<p>The <tt>Localization</tt> class adds two parameters to the system that govern its localization
behavior: 
</p>
<ul><li><tt>Language</tt> defines the language into which strings are translated; if its value matches one of the <tt>LocalizedStrings</tt> row labels, translations will be taken from that row; otherwise, strings will not be translated. A value of <tt>Default</tt> results in all strings keeping their original values.</li>
<li><tt>LocalizedStrings</tt> defines string translations. Strings that do not appear as a column label will not be translated. Also, strings with an empty translation entry in <tt>LocalizedStrings</tt> will not be translated.</li></ul>
<h3><span class="mw-headline" id="Interface_to_the_programmer">Interface to the programmer</span></h3>
<p>The <tt>LocalizedStrings</tt> parameter is empty by default. Although a user may add translations in desired languages to the empty matrix by manually using the matrix editor of the operator module, translations will preferably be provided in a filter constructor by listing them as in the following example:
</p>
<pre>#include "Localization.h"
...
TTask::TTask()
  {
  ...
  LANGUAGES "Italian",
            "French",
  BEGIN_LOCALIZED_STRINGS
   "Yes",
            "Si",
            "Oui",
    "No",
            "No",
            "Non",
  END_LOCALIZED_STRINGS
  ...
  }
</pre>
<p>If the <tt>LocalizedStrings</tt> matrix was empty before the <tt>TTask</tt> constructor gets called, it will have these entries after execution of the constructor:
</p>
<table border="1">
<tbody><tr>
<td>
</td>
<td>Yes
</td>
<td>No
</td></tr>
<tr>
<td>Italian
</td>
<td>Si
</td>
<td>No
</td></tr>
<tr>
<td>French
</td>
<td>Oui
</td>
<td>Non
</td></tr></tbody></table>
<p><br />
There may be any number of translation tables inside filter constructors, with their entries being added to the existing ones, or overriding entries that already exist.
</p><p>Once entered, the translations contained in <tt>LocalizedStrings</tt> are applied via two mechanisms:
</p>
<ul><li>The function <tt>LocalizableString()</tt> takes a string as an argument and returns the appropriate entry from <tt>LocalizedStrings</tt>, or the unmodified string if no entry can be found. For example, instead of <br /><tt>TellUser( "Well done!" );</tt><br />one would write<br /><tt>#include "Localization.h"<br />...<br />TellUser( LocalizableString( "Well done!" ) );</tt><br />to have a translation for "Well done!" looked up in <tt>LocalizedStrings</tt>.</li></ul>
<ul><li>The function <tt>ApplyLocalizations()</tt> takes a pointer to a GUI object (for the Borland VCL, this would be a <tt>TForm*</tt>) and translates all localizable text contained within it. This function must be called during <tt>GenericFilter:: Initialize</tt> for each GUI object generated from a resource file.</li></ul>
<h3><span class="mw-headline" id="Further_implementation_details">Further implementation details</span></h3>
<ul><li>You should not use <tt>LocalizableString()</tt> on string constants used before the first call to <tt>GenericFilter::Initialize()</tt> or for initializing static or global objects of any kind because localization information used will not be available at global initialization time, and local static variables, once initialized, will not be updated appropriately.</li></ul>
<ul><li>Language names are case-insensitive. You may use any string for a language name but as a convention we suggest its most common English name, as in <tt>Italian, Dutch, French, German</tt>, with international country abbreviations as optional regional qualifiers as in <tt>EnglishUS, EnglishGB, GermanA, GermanCH</tt> if necessary.</li></ul>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:302px;"><a href="https://www.bci2000.org/mediawiki/index.php/File:Table.png" class="image"><img alt="" src="../images/thumb/a/a5/Table.png/300px-Table.png" decoding="async" width="300" height="236" class="thumbimage" srcset="../images/thumb/a/a5/Table.png/450px-Table.png 1.5x, ../images/thumb/a/a5/Table.png/600px-Table.png 2x" /></a>  <div class="thumbcaption"><div class="magnify"><a href="https://www.bci2000.org/mediawiki/index.php/File:Table.png" class="internal" title="Enlarge"></a></div>table</div></div></div></div>
<p><br />
</p>
<ul><li>Encoding of non-ASCII characters follows the UTF8 convention. To ensure platform independent readability of source code files, there are macros that define HTML character names to their UTF8 encoded strings. This allows you to write<br /><tt>"Sm" oslash "rrebr" oslash "d"</tt><br />for "Smørrebrød" (cf. table 1).</li></ul>
<!-- 
NewPP limit report
Cached time: 20230524000314
Cache expiry: 86400
Dynamic content: false
Complications: []
CPU time usage: 0.024 seconds
Real time usage: 0.028 seconds
Preprocessor visited node count: 25/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key wikidb-bci_:pcache:idhash:1425-0!canonical and timestamp 20230524000314 and revision id 2420
 -->
</div></div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://www.bci2000.org/mediawiki/index.php?title=Programming_Reference:Localization&amp;oldid=2420">http://www.bci2000.org/mediawiki/index.php?title=Programming_Reference:Localization&amp;oldid=2420</a>"</div>
 </div>
</body>
</html>