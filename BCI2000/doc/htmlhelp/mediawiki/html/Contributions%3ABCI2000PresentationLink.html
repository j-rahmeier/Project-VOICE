<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Contributions:BCI2000PresentationLink - BCI2000 Help</title>
<link rel='shortcut icon' href='../../rsrc/favicon.ico' />
<style type='text/css'>
html { font-size:95%; font-family:arial,helvetica,sans-serif }
.printfooter { display:none }
#tocmain { font-size:81%; font-weight:bold; color:black; background-color:white; border:1px solid black; padding:1em; z-index:10; position:fixed; left:-1px; top:-1px; width:150px; }
#tocmain a { color:blue; text-decoration:none }
#tocmain ul { margin:0 0 0 0.4em; padding:0.1em 0 0 0.1em; list-style-position:outside; list-style-type:disc }
#tocmain li { text-indent:0; margin:0 0 0 1em; padding: 0 0 0 0 }
#tocmain p { margin:0; padding:0.1em 0 0 0.1em }
#tocmain .toc1 { margin-left:1.25em; }
#tocmain .toc2 { margin-left:2.25em; }
#tocmain .toc3 { margin-left:3.25em; }
#article { font-size:91%; position:absolute; left:200px; right:0; padding:1em; margin:0 }
</style>
</head>
<body>
 <div id='tocmain'>
 <a href='Main_Page.html'><img src='../../rsrc/bci2000logo.svg' alt='[Main Page]' /></a> <hr class="sep" /><p class="toc0"><a href="User_Tutorial%253ABCI2000_Tour.html">GettingStarted</a></p><ul></ul><p class="toc0"><a href="User_Reference%253AContents.html">User Manual</a></p><ul></ul><p class="toc0"><a href="Technical_Reference%253AContents.html">Technical Reference</a></p><ul></ul><p class="toc0"><a href="Programming_Reference%253AContents.html">Programming Manual</a></p><ul></ul><p class="toc0"><a href="Contributions%253AContents.html">Contributions</a></p><ul><li class="toc1"><a href="Contributions%253AADCs.html">Data Acquisition</a></li><li class="toc1"><a href="Contributions%253AFileWriters.html">File Formats</a></li><li class="toc1"><a href="Contributions%253ASignalProcessing.html">Signal Processing</a></li><li class="toc1"><a href="Contributions%253AApplications.html">Applications</a></li><li class="toc1"><a href="Contributions%253ATools.html">Tools</a></li></ul><hr class="sep" /><p class="toc0"><a href="BCI2000_Glossary.html">BCI2000 Glossary</a></p> </div>
 <div id='article'>
 <h1 class = "pagetitle">BCI2000PresentationLink</h1>
 <p class = "subtitle">Contributions</p>
 <hr class = "sep" />
 <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Contributions%253ABCI2000PresentationLink.html#Synopsis"><span class="tocnumber">1</span> <span class="toctext">Synopsis</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Contributions%253ABCI2000PresentationLink.html#Location"><span class="tocnumber">2</span> <span class="toctext">Location</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="Contributions%253ABCI2000PresentationLink.html#Versioning"><span class="tocnumber">3</span> <span class="toctext">Versioning</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="Contributions%253ABCI2000PresentationLink.html#Author"><span class="tocnumber">3.1</span> <span class="toctext">Author</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="Contributions%253ABCI2000PresentationLink.html#Sponsors"><span class="tocnumber">3.2</span> <span class="toctext">Sponsors</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="Contributions%253ABCI2000PresentationLink.html#Source_Code_Revisions"><span class="tocnumber">3.3</span> <span class="toctext">Source Code Revisions</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="Contributions%253ABCI2000PresentationLink.html#Functional_Description"><span class="tocnumber">4</span> <span class="toctext">Functional Description</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="Contributions%253ABCI2000PresentationLink.html#Data_Port_Extension"><span class="tocnumber">4.1</span> <span class="toctext">Data Port Extension</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="Contributions%253ABCI2000PresentationLink.html#Recording_Events"><span class="tocnumber">4.1.1</span> <span class="toctext">Recording Events</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="Contributions%253ABCI2000PresentationLink.html#Timing_Precision"><span class="tocnumber">4.1.2</span> <span class="toctext">Timing Precision</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="Contributions%253ABCI2000PresentationLink.html#Controlling_BCI2000"><span class="tocnumber">4.1.3</span> <span class="toctext">Controlling BCI2000</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-12"><a href="Contributions%253ABCI2000PresentationLink.html#PCL_Extension"><span class="tocnumber">4.2</span> <span class="toctext">PCL Extension</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="Contributions%253ABCI2000PresentationLink.html#Installation"><span class="tocnumber">5</span> <span class="toctext">Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="Contributions%253ABCI2000PresentationLink.html#Installation_Steps"><span class="tocnumber">5.1</span> <span class="toctext">Installation Steps</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="Contributions%253ABCI2000PresentationLink.html#Troubleshooting"><span class="tocnumber">5.2</span> <span class="toctext">Troubleshooting</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="Contributions%253ABCI2000PresentationLink.html#Deinstallation"><span class="tocnumber">5.3</span> <span class="toctext">Deinstallation</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="Contributions%253ABCI2000PresentationLink.html#Windows_installation_options"><span class="tocnumber">5.4</span> <span class="toctext">Windows installation options</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="Contributions%253ABCI2000PresentationLink.html#32_vs_64_bit_systems"><span class="tocnumber">5.5</span> <span class="toctext">32 vs 64 bit systems</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="Contributions%253ABCI2000PresentationLink.html#Running_a_32_bit_version_of_Presentation_on_a_64_bit_system"><span class="tocnumber">5.6</span> <span class="toctext">Running a 32 bit version of Presentation on a 64 bit system</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-20"><a href="Contributions%253ABCI2000PresentationLink.html#BCI2000PCLLibrary_Reference"><span class="tocnumber">6</span> <span class="toctext">BCI2000PCLLibrary Reference</span></a>
<ul>
<li class="toclevel-2 tocsection-21"><a href="Contributions%253ABCI2000PresentationLink.html#Constructors"><span class="tocnumber">6.1</span> <span class="toctext">Constructors</span></a>
<ul>
<li class="toclevel-3 tocsection-22"><a href="Contributions%253ABCI2000PresentationLink.html#controller.28.29"><span class="tocnumber">6.1.1</span> <span class="toctext">controller()</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="Contributions%253ABCI2000PresentationLink.html#controller.28_string_location_.29"><span class="tocnumber">6.1.2</span> <span class="toctext">controller( string location )</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-24"><a href="Contributions%253ABCI2000PresentationLink.html#Properties"><span class="tocnumber">6.2</span> <span class="toctext">Properties</span></a>
<ul>
<li class="toclevel-3 tocsection-25"><a href="Contributions%253ABCI2000PresentationLink.html#hide_window.28.29"><span class="tocnumber">6.2.1</span> <span class="toctext">hide_window()</span></a></li>
<li class="toclevel-3 tocsection-26"><a href="Contributions%253ABCI2000PresentationLink.html#show_window.28.29"><span class="tocnumber">6.2.2</span> <span class="toctext">show_window()</span></a></li>
<li class="toclevel-3 tocsection-27"><a href="Contributions%253ABCI2000PresentationLink.html#set_window_title.28_string_window_title_.29"><span class="tocnumber">6.2.3</span> <span class="toctext">set_window_title( string window_title )</span></a></li>
<li class="toclevel-3 tocsection-28"><a href="Contributions%253ABCI2000PresentationLink.html#set_subject.28_string_subject_id_.29"><span class="tocnumber">6.2.4</span> <span class="toctext">set_subject( string subject_id )</span></a></li>
<li class="toclevel-3 tocsection-29"><a href="Contributions%253ABCI2000PresentationLink.html#set_session.28_string_session_id_.29"><span class="tocnumber">6.2.5</span> <span class="toctext">set_session( string session_id )</span></a></li>
<li class="toclevel-3 tocsection-30"><a href="Contributions%253ABCI2000PresentationLink.html#set_data_directory.28_string_data_directory_.29"><span class="tocnumber">6.2.6</span> <span class="toctext">set_data_directory( string data_directory )</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-31"><a href="Contributions%253ABCI2000PresentationLink.html#Control_of_operation"><span class="tocnumber">6.3</span> <span class="toctext">Control of operation</span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="Contributions%253ABCI2000PresentationLink.html#startup_modules.28_array.28_string_.29_list_of_modules_.29"><span class="tocnumber">6.3.1</span> <span class="toctext">startup_modules( array( string ) list_of_modules )</span></a></li>
<li class="toclevel-3 tocsection-33"><a href="Contributions%253ABCI2000PresentationLink.html#set_config.28.29"><span class="tocnumber">6.3.2</span> <span class="toctext">set_config()</span></a></li>
<li class="toclevel-3 tocsection-34"><a href="Contributions%253ABCI2000PresentationLink.html#start.28.29"><span class="tocnumber">6.3.3</span> <span class="toctext">start()</span></a></li>
<li class="toclevel-3 tocsection-35"><a href="Contributions%253ABCI2000PresentationLink.html#stop.28.29"><span class="tocnumber">6.3.4</span> <span class="toctext">stop()</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-36"><a href="Contributions%253ABCI2000PresentationLink.html#Parameter_access"><span class="tocnumber">6.4</span> <span class="toctext">Parameter access</span></a>
<ul>
<li class="toclevel-3 tocsection-37"><a href="Contributions%253ABCI2000PresentationLink.html#string_get_parameter.28_string_name_.29"><span class="tocnumber">6.4.1</span> <span class="toctext">string get_parameter( string name )</span></a></li>
<li class="toclevel-3 tocsection-38"><a href="Contributions%253ABCI2000PresentationLink.html#set_parameter.28_string_name.2C_string_value_.29"><span class="tocnumber">6.4.2</span> <span class="toctext">set_parameter( string name, string value )</span></a></li>
<li class="toclevel-3 tocsection-39"><a href="Contributions%253ABCI2000PresentationLink.html#load_parameters_local.28_string_parameter_file_.29"><span class="tocnumber">6.4.3</span> <span class="toctext">load_parameters_local( string parameter_file )</span></a></li>
<li class="toclevel-3 tocsection-40"><a href="Contributions%253ABCI2000PresentationLink.html#load_parameters_remote.28_string_parameter_file_.29"><span class="tocnumber">6.4.4</span> <span class="toctext">load_parameters_remote( string parameter_file )</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-41"><a href="Contributions%253ABCI2000PresentationLink.html#State_variable_access"><span class="tocnumber">6.5</span> <span class="toctext">State variable access</span></a>
<ul>
<li class="toclevel-3 tocsection-42"><a href="Contributions%253ABCI2000PresentationLink.html#add_state_variable.28_string_name.2C_int_bit_width.2C_int_initial_value_.29"><span class="tocnumber">6.5.1</span> <span class="toctext">add_state_variable( string name, int bit_width, int initial_value )</span></a></li>
<li class="toclevel-3 tocsection-43"><a href="Contributions%253ABCI2000PresentationLink.html#double_get_state_variable.28_string_name_.29"><span class="tocnumber">6.5.2</span> <span class="toctext">double get_state_variable( string name )</span></a></li>
<li class="toclevel-3 tocsection-44"><a href="Contributions%253ABCI2000PresentationLink.html#set_state_variable.28_string_name.2C_double_value_.29"><span class="tocnumber">6.5.3</span> <span class="toctext">set_state_variable( string name, double value )</span></a></li>
<li class="toclevel-3 tocsection-45"><a href="Contributions%253ABCI2000PresentationLink.html#add_event_variable.28_string_name.2C_int_bit_width.2C_int_initial_value_.29"><span class="tocnumber">6.5.4</span> <span class="toctext">add_event_variable( string name, int bit_width, int initial_value )</span></a></li>
<li class="toclevel-3 tocsection-46"><a href="Contributions%253ABCI2000PresentationLink.html#double_get_event_variable.28_string_name_.29"><span class="tocnumber">6.5.5</span> <span class="toctext">double get_event_variable( string name )</span></a></li>
<li class="toclevel-3 tocsection-47"><a href="Contributions%253ABCI2000PresentationLink.html#set_event_variable.28_string_name.2C_double_value_.29"><span class="tocnumber">6.5.6</span> <span class="toctext">set_event_variable( string name, double value )</span></a></li>
<li class="toclevel-3 tocsection-48"><a href="Contributions%253ABCI2000PresentationLink.html#pulse_event_variable.28_string_name.2C_double_value_.29"><span class="tocnumber">6.5.7</span> <span class="toctext">pulse_event_variable( string name, double value )</span></a></li>
<li class="toclevel-3 tocsection-49"><a href="Contributions%253ABCI2000PresentationLink.html#double_get_control_signal.28_int_channel.2C_int_element_.29"><span class="tocnumber">6.5.8</span> <span class="toctext">double get_control_signal( int channel, int element )</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-50"><a href="Contributions%253ABCI2000PresentationLink.html#Operator_scripting"><span class="tocnumber">6.6</span> <span class="toctext">Operator scripting</span></a>
<ul>
<li class="toclevel-3 tocsection-51"><a href="Contributions%253ABCI2000PresentationLink.html#int_execute.28_string_command.2C_string_byRef_output_.29"><span class="tocnumber">6.6.1</span> <span class="toctext">int execute( string command, string byRef output )</span></a></li>
<li class="toclevel-3 tocsection-52"><a href="Contributions%253ABCI2000PresentationLink.html#set_script.28_string_handler.2C_string_script_.29"><span class="tocnumber">6.6.2</span> <span class="toctext">set_script( string handler, string script )</span></a></li>
<li class="toclevel-3 tocsection-53"><a href="Contributions%253ABCI2000PresentationLink.html#string_get_script.28_string_event_.29"><span class="tocnumber">6.6.3</span> <span class="toctext">string get_script( string event )</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-54"><a href="Contributions%253ABCI2000PresentationLink.html#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-55"><a href="Contributions%253ABCI2000PresentationLink.html#See_also"><span class="tocnumber">8</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Synopsis">Synopsis</span></h2>
<p>BCI2000PresentationLink contains two plug-ins for the <a rel="nofollow" class="external text" href="https://www.neurobs.com">NBS Presentation</a> stimulus delivery software, a so-called <i>DataPort Extension</i> which allows to record Presentation events into BCI2000 state variables, and a <i>PCL Language Extension</i> that allows to control BCI2000 from Presentation scripts written in the PCL language.
</p><p>Before you can use it, BCI2000PresentationLink must be installed on your system, and must be registered with the Presentation software. This is possible even if your user account has no administrative privileges. For details, see the <a href="Contributions%253ABCI2000PresentationLink.html#Installation">Installation</a> section below.
</p>
<h2><span class="mw-headline" id="Location">Location</span></h2>
<p><a rel="nofollow" class="external free" href="http://www.bci2000.org/svn/trunk/src/contrib/ExternalLinks/BCI2000PresentationLink">http://www.bci2000.org/svn/trunk/src/contrib/ExternalLinks/BCI2000PresentationLink</a>
</p>
<h2><span class="mw-headline" id="Versioning">Versioning</span></h2>
<h3><span class="mw-headline" id="Author">Author</span></h3>
<p>juergen.mellinger@uni-tuebingen.de
</p>
<h3><span class="mw-headline" id="Sponsors">Sponsors</span></h3>
<p>Sergio Ruiz and Ranga Sitaram
</p>
<h3><span class="mw-headline" id="Source_Code_Revisions">Source Code Revisions</span></h3>
<ul><li>Initial development: BCI2000 r3918; Presentation Version 15 Build 11.15.11</li>
<li>Tested under: BCI2000 r7306; Presentation Version 23.1 Build 09.29.22</li></ul>
<h2><span class="mw-headline" id="Functional_Description">Functional Description</span></h2>
<h3><span class="mw-headline" id="Data_Port_Extension">Data Port Extension</span></h3>
<p>The BCI2000PresentationLink DataPort extension provides a BCI2000 specific kind of Data Port in Presentation. In Presentation, Data Ports are objects that receive information about Presentation Events, which are triggered on Stimulus display, or from PCL scripts.
</p>
<h4><span class="mw-headline" id="Recording_Events">Recording Events</span></h4>
<p>When receiving notification about an event from Presentation, a BCI2000 Data Port transmits it to BCI2000, such that it gets recorded in the BCI2000 data file. By default, events of the following types are recorded: Picture Sound Video Nothing Response. Other Presentation event types are ignored, unless added to the Event Types list in the Data Port's settings dialog. In BCI2000 data files, events are represented as numeric values of state variables that have names matching the corresponding Presentation event type. Thus, events are best represented when their Presentation event code is an integer number in the range between 0 and 2^32; in this case, the BCI2000 state value matches the Presentation event code at the point in time when the event was received. When the Presentation event code is a string, or does not fit into the above range, its first four characters are translated into their ASCII values, and concatenated to form a 32-bit integer. While this preserves as much information as possible about events, it may make it impossible for you to distinguish events whose event codes agree in their first four characters.
</p>
<h4><span class="mw-headline" id="Timing_Precision">Timing Precision</span></h4>
<p>Presentation achieves millisecond-accuracy when measuring the time at which an event has occurred. Unfortunately, this precision does not carry over to BCI2000 because, as stated in the Presentation documentation,  the time when Presentation actually reports an event may be delayed by up to 50ms with regard to the time when it occurred. Although a Data Port object is provided with the time stamp of the event's occurrence, this information can not be utilized by BCI2000 because events cannot be dated back in time due to the way they are recorded in BCI2000. Thus, event information in a BCI2000 data file reflects the time when that event was reported to the Data Port object, not the time when its occurrence was detected. Presentation guarantees that the difference between these two time points, i.e. the delay, is below 50ms. Beyond that, they do not make any statement about how delay varies between events (timing jitter). However, in practice, one may assume that timing jitter is low, and that the delay is significantly less than the guaranteed value of 50ms.
</p><p>On a typical LCD display, frame duration is 1/(60Hz) = 16.7ms. When presenting stimuli on such a display, the delay jitter between Presentation's detection of the stimulus, and BCI2000's recording of the associated event, will be less than the duration of a single display frame, and the absolute value of the delay will correspond to about a single frame. This may be a problem when you need to measure features in evoked activity on a time scale below 1/60s, or a frequency scale above 60Hz, which is not the case in most experiments. Also note that the temporal resolution of evoked activity is only affected by jitter, not by the absolute value of the delay. When doing exact latency measurements, you should perform measurements with a light or audio sensor in order to establish an estimate for the delay, so you can correct latency measurements for the delay, as well as for its jitter, to obtain an upper limit for temporal resolution.
</p>
<h4><span class="mw-headline" id="Controlling_BCI2000">Controlling BCI2000</span></h4>
<p>Presentation provides "Resume" and "Pause" event types. By default, when a "Resume" event is received, the BCI2000 Data Port starts a BCI2000 recording (a "Run"), and when a "Pause" event is received, it stops recording. It is possible to set a subject ID, session ID, and data directory by providing this information in the "Resume" event's event code, separated by white space, where session ID and data directory may also be omitted. E.g., when sending a "Resume" event with an event code of "SUB 001 C:\my data", the recording will be stored as "C:\my data\SUB001\SUBS001R01.dat". For more information about the naming and location of data files, see the <a href="User_Reference%253ADataIOFilter.html#Common_Data_Storage_Parameters" title="User Reference:DataIOFilter">data storage parameters reference</a>.
</p>
<h3><span class="mw-headline" id="PCL_Extension">PCL Extension</span></h3>
<p>The BCI2000PresentationLink PCL extension is a PCL Library that contains a single class called BCI2000Controller. This is an interface to the BCI2000 Operator module, and allows to start up, configure, and run BCI2000 from PCL scripts.
</p><p>To use it, instantiate an object of type "bci2000::controller" by writing
</p>
<pre>bci2000::controller bci = new bci2000::controller;
</pre>
<p>This will start up the Operator module residing in the same directory as BCI2000PresentationLink. You may then use the startup_modules() method in order to start up BCI2000 core modules.
In case you have configured a BCI2000 DataPort for your experiment, the controller object's default properties are taken from the settings of the DataPort object.
</p><p>Alternatively, you may specify the path to a BCI2000 batch file in the BCI2000/batch directory as an argument to the bci2000::controller operator. The path will be interpreted relative to Presentation's working directory:
</p>
<pre>bci2000::controller bci = new bci2000::controller( "path\to\bci2000\batch\CursorTask_SignalGenerator.bat" );
</pre>
<p>An appropriate batch file should start up Operator and core modules, and needs to forward its command line arguments to the Operator module. All batch files coming with BCI2000 fulfill this condition. When a batch file is specified, there is no need to call the startup_modules() method.
</p><p>As yet another option, you may connect to an Operator module that is already running, e.g., on a remote machine on the network. In this case, call the controller's constructor with an appropriate network address and port, i.e. the telnet address the remote Operator module is listening on, i.e. the remote machine's IP address, followed with a colon, and the port specified when starting up the remote Operator module:
</p>
<pre>bci2000::controller bci = new bci2000::controller( "134.2.131.129:3999" );
</pre>
<p>The remote Operator module must have been started with the --Telnet command line option, followed with an external address to listen on. On the remote machine, this would typically be "*:3999". Don't use any of the ports between 4000 and 4002, as this will interfere with the communication between the Operator module, and BCI2000 core modules. Depending on whether the remote Operator module has been started up together with its core modules, or not, you may then call the startup_modules() method in order to start up BCI2000 core modules on the remote machine.
</p><p>Once all BCI2000 modules are running, you may load parameter files locally or remotely using the load_parameters_local() and load_parameters_remote() methods. Subject ID, Session ID, and data directory are set using the respective bci2000::controller methods.
</p><p>A recording may then be started by calling the start() method. Depending on configuration, the recording will terminate automatically, or needs to be terminated by a call to the stop() method.
</p><p>To run BCI2000 in a different configuration (i.e., with different core modules), it is not necessary to terminate the Operator module. Rather, you may execute startup_modules() multiple times in order to terminate currently running core modules, and start different ones.
</p><p>The bci2000::controller object will be deleted once its last reference goes out of scope in a PCL script. Depending on whether the Operator module was started up by the object's constructor, this will terminate the Operator module as well. Thus, you should declare that reference in the outermost scope of your PCL script. When connection was made to an already running Operator module, local or remote, the connection will be closed but the Operator module will remain running. The same applies when connection was made to an Operator module associated with a BCI2000 DataPort; then, the connection's life time corresponds to the life time of the DataPort object, i.e. the duration of the experiment.
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<h3><span class="mw-headline" id="Installation_Steps">Installation Steps</span></h3>
<p>Before you can use BCI2000PresentationLink, it must be made known to your Windows system, and to Presentation. Each time when you are using BCI2000 on a new machine, under a different user account, or when you moved BCI2000 from its original installation location, you will need to manually install BCI2000PresentationLink in the system. This can be done by double-clicking the InstallPresentationLink.cmd batch file located in BCI2000/prog.
</p><p>As a second step, BCI2000PresentationLink must be registered with Presentation. You will need to repeat this step each time you are using Presentation on a new machine, or under a different user account.
</p>
<ul><li>In the Presentation main window, choose "Extension Manager" from the "Tools" menu.</li>
<li>In the Extension Manager window, click the "Select Extension File" button, and select your BCI2000 installation's BCI2000/prog/BCI2000PresentationLink.dll file. When you have more than one BCI2000 installation, then select the BCI2000PresentationLink file from the installation you want to be used by default.</li>
<li>After clicking "OK", you will see two extensions listed under "Available Extensions", one that is a "PCL Extension", and one that is a "Data Port". Click the first entry in the list of available extensions, and enter its name into the "Register As:" field.</li>
<li>Make sure the "Dont 't register server with Windows" checkbox is checked. Then, click "Register Extension".</li>
<li>When you get an error message, make sure you are not trying to register an extension twice, and make sure that you performed installation into Windows as described above.</li>
<li>Again, click the "Select Extension File" button, and select your BCI2000PresentationLink file.</li>
<li>This time, click the second entry in the "Available Extensions" list, enter its name into the "Register As:" field, make sure the "Don't register ..." checkbox is checked, and click "Register Extension".</li>
<li>Both the BCI2000DataPortExtension, and the BCI2000PCLLibrary should now appear in the "Registered Extensions" list at the top of the Extension Manager window.</li></ul>
<p>As a third step, you will need to create a BCI2000 Data Port in your experiment. You will need to do this each time you are creating a new experiment that uses BCI2000.
</p>
<ul><li>In the Presentation window, go to the "Settings" tab.</li>
<li>In the icon band on the left, click "Port".</li>
<li>Click "Add" under "Data Ports" to the right.</li>
<li>From the "Type" drop-down menu, choose "BCI2000PresentationLink Data Port".</li>
<li>Right to that drop-down menu, a "Properties" button appears. Click it.</li>
<li>Read the description of the dialog elements in order to get an idea of your more advanced options.</li>
<li>BCI2000 must be started up in a certain configuration defined by the core module executables which to run. Such a configuration may be chosen in the Data Port properties, by clicking "Choose ..." and selecting an appropriate batch file from BCI2000/batch. Alternatively, you may start up a selection of core modules from a PCL script by instantiating a bci2000::controller object, and calling its startup_modules() method.</li>
<li>Click "OK".</li></ul>
<p>You may now record events into BCI2000 from your own experiments. For examples how to do this from both scenarios written in SDL, and PCL scripts, see the <a href="Contributions%253ABCI2000PresentationLink.html#Examples">examples section</a> below.
</p>
<h3><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h3>
<ul><li>Presentation displays an error message "An attempt was made to create a COM object for a class that is not registered":</li></ul>
<dl><dt>Execute <i>BCI2000/prog/InstallPresentationLink.cmd</i> under the user account that is going to run the Presentation program.</dt></dl>
<ul><li>When trying to register an extension, Presentation displays an error message "DLL registration failed ...":</li></ul>
<dl><dt>Make sure the "Don't register server with Windows" check box is checked when clicking "Register Extension". You may need to follow the advice of the previous troubleshooting entry as well.</dt></dl>
<h3><span class="mw-headline" id="Deinstallation">Deinstallation</span></h3>
<p>BCI2000Presentation installation adds a few registry keys to the current user's, or the machine's, "Software/Classes" key. When these keys remain on your machine after removing BCI2000, they will not do any harm, so you need not bother removing them. To remove those keys anyway, log in as the user for whom installation was performed, and execute
</p>
<pre>InstallPresentationLink /u
</pre>
<p>from a command prompt inside the BCI2000/prog directory.
</p>
<h3><span class="mw-headline" id="Windows_installation_options">Windows installation options</span></h3>
<p>BCI2000PresentationLink may be installed or deinstalled for all users of a machine, or only for the user who runs the installation script. Selection between the two is done automatically, by determining whether the user has administrator rights. If so, installation is performed per-machine; if not, installation is done per-user. To manually choose the type of installation, you will need to execute the following command from the command prompt, inside the BCI2000/prog directory:
</p>
<pre>regsvr32 /n /i:&lt;option&gt; BCI2000PresentationLink.dll
</pre>
<p>There, &lt;option&gt; may be one of the following:
</p>
<ul><li><i>user</i> to install for the current user only,</li>
<li><i>system</i> to install for all users,</li>
<li><i>any</i> to try installation for all users, and switch to per-user installation when that fails,</li>
<li><i>both</i> to install both for all users, and the current user (this option only makes sense for deinstallation).</li></ul>
<p>Note that per-user installation overrides system-wide installation. This may lead to confusing behavior of BCI2000PresentationLink when switching between multiple users, and executing the installation program for those users, or when granting a certain user administrative privileges at one time, and later removing those privileges. To completely remove all references to BCI2000PresentationLink from your machine under such circumstances, execute
</p>
<pre>regsvr32 /n /u /s /i:both BCI2000PresentationLink.dll
</pre>
<p>under all user accounts that may have executed the installation script, and make sure that at least one of those accounts has administrative privileges.
</p>
<h3><span class="mw-headline" id="32_vs_64_bit_systems">32 vs 64 bit systems</span></h3>
<p>When compiling BCI2000PresentationLink in 64 bit mode, the resulting DLL is called BCI2000PresentationLink64.dll and must be named
as such in the commands above.
</p>
<h3><span class="mw-headline" id="Running_a_32_bit_version_of_Presentation_on_a_64_bit_system">Running a 32 bit version of Presentation on a 64 bit system</span></h3>
<p>A 32 bit version of Presentation requires a 32 bit version of BCI2000PresentationLink.dll, and execution of the 32 bit version of the 
regsvr32 program inside the SysWOW64 directory:
</p>
<pre>%SystemRoot%\SysWOW64\regsvr32 /n /i:&lt;option&gt; BCI2000PresentationLink.dll
</pre>
<p>Note that the 32 and 64 bit registration processes are completely independent on a 64 bit system, and transparent for each other.
</p>
<h2><span class="mw-headline" id="BCI2000PCLLibrary_Reference">BCI2000PCLLibrary Reference</span></h2>
<p>The BCI2000 PCL Extension contains a single class type called <i>bci2000::controller</i>. To use it, instantiate a controller object by writing
</p>
<pre>bci2000::controller bci = new bci2000::controller();
</pre>
<p>This type has the following methods:
</p>
<h3><span class="mw-headline" id="Constructors">Constructors</span></h3>
<h4><span id="controller()"></span><span class="mw-headline" id="controller.28.29">controller()</span></h4>
<p>Creates a controller connecting to the first BCI2000 data port, or to the BCI2000 installation in which BCI2000PresentationLink resides.
</p>
<h4><span id="controller(_string_location_)"></span><span class="mw-headline" id="controller.28_string_location_.29">controller( string location )</span></h4>
<p>Creates a controller connecting to a BCI2000 Operator module, or to a network address. In the "location" argument, provide a path to a BCI2000 Operator module, or network address in form &lt;ip&gt;:&lt;port&gt;.
</p>
<h3><span class="mw-headline" id="Properties">Properties</span></h3>
<h4><span id="hide_window()"></span><span class="mw-headline" id="hide_window.28.29">hide_window()</span></h4>
<p>Hides the BCI2000 Operator main window.
</p>
<h4><span id="show_window()"></span><span class="mw-headline" id="show_window.28.29">show_window()</span></h4>
<p>Shows the BCI2000 Operator main window.
</p>
<h4><span id="set_window_title(_string_window_title_)"></span><span class="mw-headline" id="set_window_title.28_string_window_title_.29">set_window_title( string window_title )</span></h4>
<p>Sets the title of the BCI2000 Operator main window.
</p>
<h4><span id="set_subject(_string_subject_id_)"></span><span class="mw-headline" id="set_subject.28_string_subject_id_.29">set_subject( string subject_id )</span></h4>
<p>Sets a subject ID for the BCI2000 recording.
</p>
<h4><span id="set_session(_string_session_id_)"></span><span class="mw-headline" id="set_session.28_string_session_id_.29">set_session( string session_id )</span></h4>
<p>Sets a session ID for the BCI2000 recording.
</p>
<h4><span id="set_data_directory(_string_data_directory_)"></span><span class="mw-headline" id="set_data_directory.28_string_data_directory_.29">set_data_directory( string data_directory )</span></h4>
<p>Sets a data directory for the BCI2000 recording, relative to the BCI2000 prog directory.
Data files will be placed into a subject and session specific directory below the data directory.
</p>
<h3><span class="mw-headline" id="Control_of_operation">Control of operation</span></h3>
<h4><span id="startup_modules(_array(_string_)_list_of_modules_)"></span><span class="mw-headline" id="startup_modules.28_array.28_string_.29_list_of_modules_.29">startup_modules( array( string ) list_of_modules )</span></h4>
<p>Starts up a given set of core modules (typically, a Source, SignalProcessing, and Application module). In the argument, provide a list of module executables, optionally with their command line options.
</p>
<h4><span id="set_config()"></span><span class="mw-headline" id="set_config.28.29">set_config()</span></h4>
<p>Applies current set of parameters to the BCI2000 system.
</p>
<h4><span id="start()"></span><span class="mw-headline" id="start.28.29">start()</span></h4>
<p>Starts operation.
</p>
<h4><span id="stop()"></span><span class="mw-headline" id="stop.28.29">stop()</span></h4>
<p>Suspends operation.
</p>
<h3><span class="mw-headline" id="Parameter_access">Parameter access</span></h3>
<h4><span id="string_get_parameter(_string_name_)"></span><span class="mw-headline" id="string_get_parameter.28_string_name_.29">string get_parameter( string name )</span></h4>
<p>Returns the value of the specified parameter.
</p>
<h4><span id="set_parameter(_string_name,_string_value_)"></span><span class="mw-headline" id="set_parameter.28_string_name.2C_string_value_.29">set_parameter( string name, string value )</span></h4>
<p>Sets the value of the specified parameter.
</p>
<h4><span id="load_parameters_local(_string_parameter_file_)"></span><span class="mw-headline" id="load_parameters_local.28_string_parameter_file_.29">load_parameters_local( string parameter_file )</span></h4>
<p>Loads a parameter file relative to Presentation's working directory.
</p>
<h4><span id="load_parameters_remote(_string_parameter_file_)"></span><span class="mw-headline" id="load_parameters_remote.28_string_parameter_file_.29">load_parameters_remote( string parameter_file )</span></h4>
<p>Loads a parameter file relative to the BCI2000/prog directory.
</p>
<h3><span class="mw-headline" id="State_variable_access">State variable access</span></h3>
<h4><span id="add_state_variable(_string_name,_int_bit_width,_int_initial_value_)"></span><span class="mw-headline" id="add_state_variable.28_string_name.2C_int_bit_width.2C_int_initial_value_.29">add_state_variable( string name, int bit_width, int initial_value )</span></h4>
<p>Adds a state variable to the system. This is only possible before core modules have connected to the Operator module.
</p>
<h4><span id="double_get_state_variable(_string_name_)"></span><span class="mw-headline" id="double_get_state_variable.28_string_name_.29">double get_state_variable( string name )</span></h4>
<p>Returns the value of a BCI2000 state variable.
</p>
<h4><span id="set_state_variable(_string_name,_double_value_)"></span><span class="mw-headline" id="set_state_variable.28_string_name.2C_double_value_.29">set_state_variable( string name, double value )</span></h4>
<p>Sets the value of a BCI2000 state variable.
</p>
<h4><span id="add_event_variable(_string_name,_int_bit_width,_int_initial_value_)"></span><span class="mw-headline" id="add_event_variable.28_string_name.2C_int_bit_width.2C_int_initial_value_.29">add_event_variable( string name, int bit_width, int initial_value )</span></h4>
<p>Adds an event variable to the system. This is only possible before core modules have connected to the Operator module.
</p>
<h4><span id="double_get_event_variable(_string_name_)"></span><span class="mw-headline" id="double_get_event_variable.28_string_name_.29">double get_event_variable( string name )</span></h4>
<p>Returns the value of a BCI2000 event variable.
</p>
<h4><span id="set_event_variable(_string_name,_double_value_)"></span><span class="mw-headline" id="set_event_variable.28_string_name.2C_double_value_.29">set_event_variable( string name, double value )</span></h4>
<p>Sets the value of a BCI2000 event variable.
</p>
<h4><span id="pulse_event_variable(_string_name,_double_value_)"></span><span class="mw-headline" id="pulse_event_variable.28_string_name.2C_double_value_.29">pulse_event_variable( string name, double value )</span></h4>
<p>Sets the value of a BCI2000 event variable for a single sample duration.
</p><p><br />
</p>
<h4><span id="double_get_control_signal(_int_channel,_int_element_)"></span><span class="mw-headline" id="double_get_control_signal.28_int_channel.2C_int_element_.29">double get_control_signal( int channel, int element )</span></h4>
<p>Returns the value of an element in the control signal. Indices are 1-based.
</p>
<h3><span class="mw-headline" id="Operator_scripting">Operator scripting</span></h3>
<h4><span id="int_execute(_string_command,_string_byRef_output_)"></span><span class="mw-headline" id="int_execute.28_string_command.2C_string_byRef_output_.29">int execute( string command, string byRef output )</span></h4>
<p>Execute an arbitrary BCI2000 scripting command. The meaning of the return value depends on which command has been executed, and is the <i>exit code</i> of the command, as defined in the <a href="Programming_Reference%253ABCI2000Remote_Class.html#bool_Execute.28_string_command.2C_int.2A_exitCode_.3D_0_.29" title="Programming Reference:BCI2000Remote Class">BCI2000Remote Class Document</a>.
</p><p>A full documentation of BCI2000 Operator scripting commands is available under <a href="User_Reference%253AOperator_Module_Scripting.html" title="User Reference:Operator Module Scripting">User Reference:Operator Module Scripting</a>.
</p>
<h4><span id="set_script(_string_handler,_string_script_)"></span><span class="mw-headline" id="set_script.28_string_handler.2C_string_script_.29">set_script( string handler, string script )</span></h4>
<p>Associates BCI2000 Operator scripting commands, given in "script", with a handler whose name is given in the "handler" argument. See <a href="User_Reference%253AOperator_Module_Scripting.html#Handlers" title="User Reference:Operator Module Scripting">User Reference:Operator Module Scripting#Handlers</a> for a list of handler names.
</p>
<h4><span id="string_get_script(_string_event_)"></span><span class="mw-headline" id="string_get_script.28_string_event_.29">string get_script( string event )</span></h4>
<p>Returns BCI2000 Operator scripting commands associated with an event.
</p>
<h2><span class="mw-headline" id="Examples">Examples</span></h2>
<p>Full examples for both stimulus presentation and feedback paradigms are available in the <i>Examples</i> subdirectory of the BCI2000PresentationLink directory.
</p>
<pre>scenario = "Minimal BCI2000 example";

begin;
# Trial definitions
...

begin_pcl;

# Create a BCI2000 controller object.
bci2000::controller bci = new bci2000::controller;

# Start up modules.
array&lt;string&gt; modules[3] =
{ "SignalGenerator", "DummySignalProcessing", "DummyApplication" };
bci.startup_modules( modules );

# Synchronize BCI2000 subject id with Presentation's.
bci.set_subject( logfile.subject() );
bci.set_session( "001" );

bci.load_parameters_remote( "myparms.prm" );

# Suppress display of default visualization windows.
bci.set_parameter( "VisualizeTiming", "0" );
bci.set_parameter( "VisualizeSource", "0" );

bci.set_config();
bci.start();

# Trial presentation
...

bci.stop();
</pre>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<p><a href="Programming_Reference%253ABCI2000Remote_Class.html" title="Programming Reference:BCI2000Remote Class">Programming Reference:BCI2000Remote Class</a>, <a href="Contributions%253ABCI2000Automation.html" title="Contributions:BCI2000Automation">Contributions:BCI2000Automation</a>, <a href="Contributions%253ABCI2000Command.html" title="Contributions:BCI2000Command">Contributions:BCI2000Command</a>, <a href="Contributions%253ABCI2000PythonBindings.html" title="Contributions:BCI2000PythonBindings">Contributions:BCI2000PythonBindings</a>, 
<a href="Contributions%253AApplications.html" title="Contributions:Applications">Contributions:Applications</a>
</p>
<!-- 
NewPP limit report
Cached time: 20230524133924
Cache expiry: 86400
Dynamic content: false
Complications: []
CPU time usage: 0.044 seconds
Real time usage: 0.047 seconds
Preprocessor visited node count: 178/1000000
Post‐expand include size: 15/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 718/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key wikidb-bci_:pcache:idhash:2042-0!canonical and timestamp 20230524133924 and revision id 10150
 -->
</div></div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://www.bci2000.org/mediawiki/index.php?title=Contributions:BCI2000PresentationLink&amp;oldid=10150">http://www.bci2000.org/mediawiki/index.php?title=Contributions:BCI2000PresentationLink&amp;oldid=10150</a>"</div>
 </div>
</body>
</html>