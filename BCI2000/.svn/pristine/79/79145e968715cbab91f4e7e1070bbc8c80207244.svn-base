<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Contributions:vAmpADC - BCI2000 Help</title>
<link rel='shortcut icon' href='../../rsrc/favicon.ico' />
<style type='text/css'>
html { font-size:95%; font-family:arial,helvetica,sans-serif }
.printfooter { display:none }
#tocmain { font-size:81%; font-weight:bold; color:black; background-color:white; border:1px solid black; padding:1em; z-index:10; position:fixed; left:-1px; top:-1px; width:150px; }
#tocmain a { color:blue; text-decoration:none }
#tocmain ul { margin:0 0 0 0.4em; padding:0.1em 0 0 0.1em; list-style-position:outside; list-style-type:disc }
#tocmain li { text-indent:0; margin:0 0 0 1em; padding: 0 0 0 0 }
#tocmain p { margin:0; padding:0.1em 0 0 0.1em }
#tocmain .toc1 { margin-left:1.25em; }
#tocmain .toc2 { margin-left:2.25em; }
#tocmain .toc3 { margin-left:3.25em; }
#article { font-size:91%; position:absolute; left:200px; right:0; padding:1em; margin:0 }
</style>
</head>
<body>
 <div id='tocmain'>
 <a href='Main_Page.html'><img src='../../rsrc/bci2000logo.svg' alt='[Main Page]' /></a> <hr class="sep" /><p class="toc0"><a href="User_Tutorial%253ABCI2000_Tour.html">GettingStarted</a></p><ul></ul><p class="toc0"><a href="User_Reference%253AContents.html">User Manual</a></p><ul></ul><p class="toc0"><a href="Technical_Reference%253AContents.html">Technical Reference</a></p><ul></ul><p class="toc0"><a href="Programming_Reference%253AContents.html">Programming Manual</a></p><ul></ul><p class="toc0"><a href="Contributions%253AContents.html">Contributions</a></p><ul><li class="toc1"><a href="Contributions%253AADCs.html">Data Acquisition</a></li><li class="toc1"><a href="Contributions%253AFileWriters.html">File Formats</a></li><li class="toc1"><a href="Contributions%253ASignalProcessing.html">Signal Processing</a></li><li class="toc1"><a href="Contributions%253AApplications.html">Applications</a></li><li class="toc1"><a href="Contributions%253ATools.html">Tools</a></li></ul><hr class="sep" /><p class="toc0"><a href="BCI2000_Glossary.html">BCI2000 Glossary</a></p> </div>
 <div id='article'>
 <h1 class = "pagetitle">vAmpADC</h1>
 <p class = "subtitle">Contributions</p>
 <hr class = "sep" />
 <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Contributions%253AvAmpADC.html#Function"><span class="tocnumber">1</span> <span class="toctext">Function</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="Contributions%253AvAmpADC.html#V-Amp_Hardware"><span class="tocnumber">1.1</span> <span class="toctext">V-Amp Hardware</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="Contributions%253AvAmpADC.html#Installation"><span class="tocnumber">2</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="Contributions%253AvAmpADC.html#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="Contributions%253AvAmpADC.html#SamplingRate"><span class="tocnumber">3.1</span> <span class="toctext">SamplingRate</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="Contributions%253AvAmpADC.html#HPFilterCorner"><span class="tocnumber">3.2</span> <span class="toctext">HPFilterCorner</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="Contributions%253AvAmpADC.html#SampleBlockSize"><span class="tocnumber">3.3</span> <span class="toctext">SampleBlockSize</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="Contributions%253AvAmpADC.html#SourceCh"><span class="tocnumber">3.4</span> <span class="toctext">SourceCh</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="Contributions%253AvAmpADC.html#SourceChList"><span class="tocnumber">3.5</span> <span class="toctext">SourceChList</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="Contributions%253AvAmpADC.html#AcquisitionMode"><span class="tocnumber">3.6</span> <span class="toctext">AcquisitionMode</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="Contributions%253AvAmpADC.html#Additional_Information"><span class="tocnumber">4</span> <span class="toctext">Additional Information</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="Contributions%253AvAmpADC.html#Data_Storage"><span class="tocnumber">4.1</span> <span class="toctext">Data Storage</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="Contributions%253AvAmpADC.html#V-Amp_Service_Troubleshooting"><span class="tocnumber">4.2</span> <span class="toctext">V-Amp Service Troubleshooting</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="Contributions%253AvAmpADC.html#See_also"><span class="tocnumber">5</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Function">Function</span></h2>
<p>The <i>vAmpADC</i> filter acquires data from a <i>V-Amp</i> or <i>FirstAmp</i> EEG amplifier. 
The <i>V-Amp</i> is an amplifier/digitizer combination from Brain Products.
Support for this device in BCI2000 consists of a BCI2000-compatible Source Module (<i>vAmpSource.exe</i>).
</p>
<h3><span class="mw-headline" id="V-Amp_Hardware">V-Amp Hardware</span></h3>
<p>The V-Amp consists of 16 independent 24-bit A/D converters that can sample at 
up to 2 kHz per channel (16 channels, plus 2 auxiliary) or 20kHz per channel (4 channels).
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>The necessary system drivers are located in the BCI2000\src\extlib\brainproducts\vamp\ folder. To install the driver, follow these steps:
</p>
<ol><li>Plug in the V-Amp to a USB port. Windows should recognize it, and start to install drivers.</li>
<li>Depending on the version of Windows being used, a Found New Hardware dialog should appear. Do NOT search online for drivers; instead, select Don't Search Online.</li>
<li>When it asks you to insert the disc that came with the amplifier, select the option that allows you to browse for the driver.</li>
<li>Navigate to BCI2000\src\extlib\brainproducts\vamp\. It should find the driver files, and installed the necessary software.</li>
<li>For the last step, copy the files DiBpGmbH.dll and FirstAmp.dll to the BCI2000\prog\ folder.</li>
<li>You should now be able to run the vAmpSource.exe module in BCI2000.</li></ol>
<h2><span class="mw-headline" id="Parameters">Parameters</span></h2>
<p>Parameters common to all source modules are described under <a href="User_Reference%253ADataIOFilter.html" title="User Reference:DataIOFilter">User Reference:DataIOFilter</a>.
In addition, the <i>vAmpADC</i> provides the following parameters:
</p>
<h3><span class="mw-headline" id="SamplingRate">SamplingRate</span></h3>
<p>The sample rate of the system. All data is either acquired at 2000 Hz or 20 kHz, and then decimated to the desired rate. Therefore, only rates that are integer divisors of the base rates are accepted. In 2000 Hz mode, the valid rates are:
</p>
<ul><li>2000</li>
<li>1000</li>
<li>666.6</li>
<li>500</li>
<li>400</li>
<li>333.3</li>
<li>285.7</li>
<li>250</li>
<li>222.22</li>
<li>200</li></ul>
<p>In 20 kHz mode, 10 times the above rates are valid.
Prior to decimation, a 2nd-order anti-aliasing Butterworth filter with a corner frequency of 0.45 times the sample rate is applied to the signal.
All sampling rates are supported for one or more amplifiers. If you are sampling at high rates, the CPU may be overloaded depending on the speed of your computer and the BCI2000 configuration. In case you are experiencing problems (e.g., data loss, jerky display, etc.), increase the SampleBlockSize so that you are updating the system less frequently (usually, updating the system 20-30 times per second is sufficient for most applications), and increase Visualize-&gt;VisualizeSourceDecimation. This parameter will decrease the number of samples per second that are actually drawn in the Source display.
</p>
<h3><span class="mw-headline" id="HPFilterCorner">HPFilterCorner</span></h3>
<p>A high-pass digital filter for removing DC offsets. This occurs after data has been read into BCI2000.
</p>
<h3><span class="mw-headline" id="SampleBlockSize">SampleBlockSize</span></h3>
<p>Samples per channel per digitized block. 
Together with the sampling rate, this parameter determines how often per second data are collected, processed, and feedback is updated. For example, at 600 Hz sampling and a SampleBlockSize of 20, the system (e.g., source signal display, signal processing, and stimulus presentation) will be updated 30 times per second.
</p>
<h3><span class="mw-headline" id="SourceCh">SourceCh</span></h3>
<p>The total number of channels. In high-speed mode, this number may not be higher than 5 (4 channels + digital).
</p>
<h3><span class="mw-headline" id="SourceChList">SourceChList</span></h3>
<p>The list of channels that should be acquired from the vAmp device.
The total number of channels listed should correspond to <i>SourceCh</i>. 
The order of channels does not matter; i.e., '1 2 3 4' is the same as '2 3 1 4'. The channels are always in ascending order.
Channels may not be listed twice; e.g., entering '1 2 3 4 5 6 7 1' if <i>SourceCh</i> = '8' will result in an error.
If this parameter is left blank (the default), then all channels are acquired.
For the V-Amp 16, channels 1-16 are EEG channels, 17-18 are Auxiliary channels, and 19 are the 8 digital channels stored in bits.
For the V-Amp 8, channels 1-8 are EEG channels, 9-10 are Auxiliary channels and 11 is the digital channel.
</p>
<h3><span class="mw-headline" id="AcquisitionMode">AcquisitionMode</span></h3>
<ul><li>If set to <i>analog signal acquisition</i>, the V-Amp records analog signal voltages (default).</li>
<li>If set to <i>high-speed acquisition</i>, the V-Amp records analog signals at 20 kHz instead of 2000 Hz.</li>
<li>If set to <i>Calibration</i>, the signal output is a square wave test signal generated by the V-Amp (which can be used to verify correct system calibration).</li>
<li>If set to <i>Impedance</i>, impedance data is recorded instead of the signal. The impedance values are showm in the V-Amp display. Values are currently updated 3 times per second.</li>
<li>If set to <i>high-speed calibration</i>, a square wave is generated at 20 kHz.</li></ul>
<h2><span class="mw-headline" id="Additional_Information">Additional Information</span></h2>
<h3><span class="mw-headline" id="Data_Storage">Data Storage</span></h3>
<ul><li>The signal is originally recorded from the V-Amp as 32-bit integers, and converted into <img class="mwe-math-fallback-image-inline tex" alt="\mu V" src="../images/math/a/0/c/a0c8c64b8931b67b0ceb94b284b27e20.png" />.</li>
<li>The auxiliary input units are in volts.</li>
<li>(<i>SourceChOffset</i> is assumed (and required) to be zero for all channels.)</li></ul>
<p>BCI2000 Signal Processing or any offline analysis routine can derive, as with any other BCI2000 source module, sample values in <img class="mwe-math-fallback-image-inline tex" alt="\mu V" src="../images/math/a/0/c/a0c8c64b8931b67b0ceb94b284b27e20.png" /> by subtracting, from each stored sample, <i>SourceChOffset</i> (i.e., zero), and multiplying it with <i>SourceChGain</i> for each channel. If <i>SignalType</i> is set to float32, data samples are stored in units of <img class="mwe-math-fallback-image-inline tex" alt="\mu V" src="../images/math/a/0/c/a0c8c64b8931b67b0ceb94b284b27e20.png" />. In this case, <i>SourceChGain</i> should be a list of 1's (because the conversion factor between data samples into <img class="mwe-math-fallback-image-inline tex" alt="\mu V" src="../images/math/a/0/c/a0c8c64b8931b67b0ceb94b284b27e20.png" /> is 1.0 for each channel). Still, when values other than 0 and 1 are specified, a consistent data file will be produced, i.e. values will be transformed before they are written to the file, such that applying SourceChOffset and SourceChGain will reproduce the original values in <img class="mwe-math-fallback-image-inline tex" alt="\mu V" src="../images/math/a/0/c/a0c8c64b8931b67b0ceb94b284b27e20.png" />.
</p>
<h3><span class="mw-headline" id="V-Amp_Service_Troubleshooting">V-Amp Service Troubleshooting</span></h3>
<p>Please note that when BrainVision Recorder was running on the computer before you are using BCI2000 there is a daemon service called "VAmpService.exe" running in background on the computer. This service must be stopped before using V-Amp amplifier. 
</p><p><a href="https://www.bci2000.org/mediawiki/index.php/File:Log_VampServiceDetected.png" class="image"><img alt="Log VampServiceDetected.png" src="../images/e/e7/Log_VampServiceDetected.png" decoding="async" width="1012" height="301" /></a>
</p><p><br />
In order to stop the “VAmpService.exe”, the following steps need to be done:
</p><p>1. Open Windows Start menu by clicking on icon <a href="https://www.bci2000.org/mediawiki/index.php/File:StartWin.png" class="image"><img alt="StartWin.png" src="../images/6/6c/StartWin.png" decoding="async" width="73" height="41" /></a>  in left-bottom corner.
</p><p>2. In Windows Start menu type Services, and click on „Services“ when it appears in the menu. 
</p><p><a href="https://www.bci2000.org/mediawiki/index.php/File:VampServiceOff_step1.png" class="image"><img alt="VampServiceOff step1.png" src="../images/2/23/VampServiceOff_step1.png" decoding="async" width="426" height="516" /></a>
</p><p><br />
3. Service window opens, showing the list of services running on your PC.
</p><p><a href="https://www.bci2000.org/mediawiki/index.php/File:ServiceExplorer.png" class="image"><img alt="ServiceExplorer.png" src="../images/5/55/ServiceExplorer.png" decoding="async" width="1262" height="903" /></a>
</p><p>4. Search for the „VAmpService“ in the list.
</p><p>5. Right-click on „VAmpService“ and the drop-down menu will appear.
</p><p>6. From the drop-down menu select “Stop”. This action stops the service.
</p><p>Now you can use V-Amp device.
</p><p><br />
A more convenient way to solve this problem is to edit the *.bat-file for your experiment like described below, especially if you are using BCI2000 and BrainVision Recorder alternately. This avoids problems with BrainVision Recorder that you might encounter when killing the "VampService.exe" process.
</p>
<pre><b>start C:\Vision\Recorder\VAmpService.exe -Uninstall</b>
cd ..\prog
start <b>vAmpSource.exe</b> 127.0.0.1
start ARSignalProcessing 127.0.0.1
start CursorTask.exe 127.0.0.1
<b>operator.exe</b>
<b>start C:\Vision\Recorder\VAmpService.exe -Install</b>
cd ..
</pre>
<p>Make sure that the path to "VAmpService.exe" is correct on your system.
Please keep in mind that you have to customize the *.bat-file shown above regarding your experiment. For using the V-Amp in the way described, the highlightened parts are important.
Please note that the commandline-window will stay open during the usage of BCI2000 (unlike when using the other *.bat-files) because of the operator.exe is started without the "start"-parameter. This is necessary to make sure that the VAmpService.exe process is started again just when BCI2000 is closed.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<p><a href="User_Reference%253AFilters.html" title="User Reference:Filters">User Reference:Filters</a>, <a href="Contributions%253AADCs.html" title="Contributions:ADCs">Contributions:ADCs</a>
</p>
<!-- 
NewPP limit report
Cached time: 20230524001318
Cache expiry: 86400
Dynamic content: false
Complications: []
CPU time usage: 0.030 seconds
Real time usage: 0.034 seconds
Preprocessor visited node count: 71/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 670/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key wikidb-bci_:pcache:idhash:1869-0!canonical!math=0 and timestamp 20230524001318 and revision id 7635
 -->
</div></div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://www.bci2000.org/mediawiki/index.php?title=Contributions:vAmpADC&amp;oldid=7635">http://www.bci2000.org/mediawiki/index.php?title=Contributions:vAmpADC&amp;oldid=7635</a>"</div>
 </div>
</body>
</html>