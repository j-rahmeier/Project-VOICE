<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>BioRadio 150 DLL: Example Program</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="pageExampleProgram">Example Program </a></h1><h2><a class="anchor" name="exampleCode">
BioRadio150DLL_Example.cpp</a></h2>
<div class="fragment"><pre class="fragment"><span class="comment">//---------------------------------------------------------------------------</span>
<span class="preprocessor">#include &lt;vcl.h&gt;</span>
<span class="preprocessor">#include &lt;iostream.h&gt;</span>
<span class="preprocessor">#include &lt;conio.h&gt;</span>  
<span class="preprocessor">#include &lt;values.h&gt;</span>

<span class="preprocessor">#include "<a class="code" href="_bio_radio150_d_l_l_8h.html">BioRadio150DLL.h</a>"</span>

<span class="preprocessor">#pragma hdrstop</span>
<span class="preprocessor"></span><span class="preprocessor">#pragma argsused</span>
<span class="preprocessor"></span>
<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])
{
  <span class="keywordtype">char</span> *configFilePath = <span class="stringliteral">"C:\\CleveMed\\TestBioRadioConfig.ini"</span>;
  <span class="keyword">const</span> <span class="keywordtype">int</span> FAST_INPUTS_BUFFER_SIZE = 20000;
  <span class="keyword">const</span> <span class="keywordtype">int</span> SLOW_INPUTS_BUFFER_SIZE = 10000;
  <span class="keyword">const</span> <span class="keywordtype">int</span> ACQUISITION_INTERVAL = 50; <span class="comment">// (milliseconds)</span>

  <span class="comment">/* FIND DEVICES */</span>
  <span class="keyword">const</span> <span class="keywordtype">int</span> MAX_DEVICES = 10;
  <a class="code" href="_bio_radio150_d_l_l_8h.html#00d4f309c7e8028871506f3d3f7532ac">TUpdateStatusEvent</a> <a class="code" href="_bio_radio150_d_l_l_8h.html#0503c85d1deea29fd1eaf373410747ef">UpdateStatusFunc</a> = NULL;
  <span class="keywordtype">char</span> *portName;
        <span class="keywordtype">int</span> deviceCount = 0;
  <a class="code" href="struct_t_device_info.html">TDeviceInfo</a> DeviceList[MAX_DEVICES];
  cout &lt;&lt; <span class="stringliteral">"Searching for BioRadio 150 Computer Units..."</span> &lt;&lt; endl;
        <a class="code" href="_bio_radio150_d_l_l_8h.html#a2e8668ea02c1474f294c574d7178ed0">FindDevices</a>(DeviceList, &amp;deviceCount, MAX_DEVICES, UpdateStatusFunc);
  cout &lt;&lt; <span class="stringliteral">"Found "</span> &lt;&lt; deviceCount &lt;&lt; <span class="stringliteral">" BioRadio 150 Computer Units:"</span>;
  <span class="keywordflow">if</span> (deviceCount &gt; 0) {
                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;deviceCount; i++) {
                        cout &lt;&lt; ((i!=0) ? <span class="stringliteral">", "</span> : <span class="stringliteral">" "</span>) &lt;&lt; DeviceList[i].<a class="code" href="struct_t_device_info.html#603946bd16589dce7a09529059adfb91">PortName</a>;
    }
    portName = DeviceList[0].<a class="code" href="struct_t_device_info.html#603946bd16589dce7a09529059adfb91">PortName</a>;
    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">"Using "</span> &lt;&lt; portName &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; endl;
        } <span class="keywordflow">else</span> {
    cout &lt;&lt; <span class="stringliteral">"Exiting."</span> &lt;&lt; endl;
        system(<span class="stringliteral">"pause"</span>);
        <span class="keywordflow">return</span> -1;
  }

  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> devHandle;

  devHandle = <a class="code" href="group___create_destroy.html#gf85bf44f83d0b6383dd727ef810c927e">CreateBioRadio</a>();
  cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">"Create BioRadio Object... ("</span> &lt;&lt; devHandle &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; endl;

  <a class="code" href="group___acq.html#gc1d8f548691ceee2932a70e04d4f3cd7">SetBadDataValues</a>(devHandle, -65535, 65535);

  <span class="keywordflow">if</span> (devHandle&gt;0) {
        <span class="comment">/* START COMMUNICATION */</span>
    <span class="keywordtype">int</span> successFlag = <a class="code" href="group___start_stop.html#g35e3f777938c9abee24b53b39fe78bf2">StartCommunication</a>(devHandle, portName);
    cout &lt;&lt; <span class="stringliteral">"Start Comm... ("</span> &lt;&lt; successFlag &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; endl &lt;&lt; endl;
    <span class="keywordflow">if</span> (successFlag &gt; 0){
      <span class="comment">/* START ACQUISITION */</span>
            successFlag = <a class="code" href="group___start_stop.html#g6590399f02fc04ed2df7afd0404be8ee">StartAcq</a>(devHandle, 1);
            cout &lt;&lt; <span class="stringliteral">"Start Acq... ("</span> &lt;&lt; successFlag &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; endl;
            <span class="keywordflow">if</span> (successFlag &gt; 0){
        <span class="comment">/* PROGRAM CONFIGURATION */</span>
        successFlag = <a class="code" href="group___config.html#g07eeb437d4ba506335c35888ca4a65ac">ProgramConfig</a>(devHandle, 1, configFilePath);
        cout &lt;&lt; <span class="stringliteral">"Program Config... ("</span> &lt;&lt; successFlag &lt;&lt; <span class="stringliteral">")\n"</span> &lt;&lt; endl;
              <span class="keywordflow">if</span> (successFlag &gt; 0){
            <span class="keywordtype">int</span> numFastMainInputs, numFastAuxInputs, numSlowInputs;
          <span class="keywordtype">int</span> numTotalInputs = <a class="code" href="group___config.html#gc41144798858f150b9879c3d441debd7">GetNumEnabledInputs</a>(devHandle,
            &amp;numFastMainInputs, &amp;numFastAuxInputs, &amp;numSlowInputs);
            cout &lt;&lt; <span class="stringliteral">"Inputs: "</span> &lt;&lt; numFastMainInputs &lt;&lt; <span class="stringliteral">" fast main, "</span> &lt;&lt; numFastAuxInputs &lt;&lt;
            <span class="stringliteral">" fast aux, "</span> &lt;&lt; numSlowInputs &lt;&lt; <span class="stringliteral">" slow, "</span> &lt;&lt; numTotalInputs &lt;&lt; <span class="stringliteral">" total"</span> &lt;&lt; endl;
            cout &lt;&lt; <span class="stringliteral">"Sample Rate = "</span> &lt;&lt; <a class="code" href="group___config.html#ge97b4783f3f0fc1f4741d0f725522e82">GetSampleRate</a>(devHandle) &lt;&lt; endl;
        
            <span class="keywordtype">double</span> FastInputsData[FAST_INPUTS_BUFFER_SIZE];
            WORD SlowInputsData[SLOW_INPUTS_BUFFER_SIZE];
            <span class="keywordtype">int</span> FastInputsNumRead, SlowInputsNumRead, readReturn;
                                        <span class="keywordtype">int</span> statusCount = 0;

          <span class="keywordflow">while</span> (!kbhit()) {
                <span class="comment">/* REQUEST DATA EVERY 50MS UNTIL KEY PRESSED */</span>
            cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">"Tfr Buffer... ("</span> &lt;&lt; <a class="code" href="group___acq.html#g01f79f89e66cfc0d8df20d0e5052f7df">TransferBuffer</a>(devHandle) &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; endl;
            readReturn = <a class="code" href="group___acq.html#gdec72dc14ef3e449ca5c43ad63523326">ReadScaledFastAndSlowData</a>(devHandle,
              FastInputsData, FAST_INPUTS_BUFFER_SIZE, &amp;FastInputsNumRead,
              SlowInputsData, SLOW_INPUTS_BUFFER_SIZE, &amp;SlowInputsNumRead);
            cout &lt;&lt; <span class="stringliteral">"Read Data... ("</span> &lt;&lt; readReturn &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; endl;
            cout &lt;&lt; <span class="stringliteral">"Fast Inputs Num Read = "</span> &lt;&lt; FastInputsNumRead &lt;&lt; endl;
            cout &lt;&lt; <span class="stringliteral">"Slow Inputs Num Read = "</span> &lt;&lt; SlowInputsNumRead &lt;&lt; endl;
            <span class="keywordflow">if</span> (statusCount++ &gt;= 20) {
                statusCount = 0;
                cout &lt;&lt; endl;
              cout &lt;&lt; <span class="stringliteral">"  BatteryStatus = "</span> &lt;&lt; <a class="code" href="group___misc.html#g3df1bf3bc4147975b7043c9c968dd9ce">GetBatteryStatus</a>(devHandle) &lt;&lt; endl;
                                                        cout &lt;&lt; <span class="stringliteral">"  RSSI: "</span> &lt;&lt; <a class="code" href="group___link.html#g29b6746ec5c9fd269991f7da27f6cac8">GetUpRSSI</a>(devHandle) &lt;&lt; <span class="stringliteral">" up / "</span> &lt;&lt; <a class="code" href="group___link.html#g784b72c420ac296250436d2a6b5e434a">GetDownRSSI</a>(devHandle) &lt;&lt; <span class="stringliteral">" down"</span> &lt;&lt; endl;
                                                        cout &lt;&lt; <span class="stringliteral">"  BufSz: "</span> &lt;&lt; <a class="code" href="group___link.html#gb60ae1253960f9ef714f479e20084299">GetLinkBufferSize</a>(devHandle) &lt;&lt; endl;
                                                        cout &lt;&lt; <span class="stringliteral">"  BEC: "</span> &lt;&lt; <a class="code" href="group___link.html#gdefc0b88d9bbf2bb1add37ba0b0cfead">GetBitErrCount</a>(devHandle) &lt;&lt; endl;
                                                        cout &lt;&lt; <span class="stringliteral">"  BER: "</span> &lt;&lt; <a class="code" href="group___link.html#g8b750ddd6c7f91dd41bf4f3f72645396">GetBitErrRate</a>(devHandle) &lt;&lt; endl;
                                                        cout &lt;&lt; <span class="stringliteral">"  Pkts: "</span> &lt;&lt; <a class="code" href="group___link.html#g723c2a3a026dd9bb8a171dc9a225d330">GetGoodPackets</a>(devHandle) &lt;&lt; <span class="stringliteral">" good "</span> &lt;&lt;
                                    <a class="code" href="group___link.html#g9a958d7b3bbde36574342ba55004fea8">GetBadPackets</a>(devHandle) &lt;&lt; <span class="stringliteral">" bad "</span> &lt;&lt;
                                    <a class="code" href="group___link.html#g6d61bcffb26aec79af35b0700baec398">GetDroppedPackets</a>(devHandle) &lt;&lt; <span class="stringliteral">" dropped"</span> &lt;&lt; endl;
            }
            Sleep(ACQUISITION_INTERVAL);
          }
              }
        <span class="comment">/* STOP ACQUISITION */</span>
              cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">"Stop Acq... ("</span> &lt;&lt; <a class="code" href="group___start_stop.html#g18ce2ea844cdab6360bd9bce301c99a8">StopAcq</a>(devHandle) &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt;  endl;
            }
      <span class="comment">/* STOP COMMUNICATION */</span>
      cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">"Stop Comm... ("</span> &lt;&lt; <a class="code" href="group___start_stop.html#gd3533264f65482feb1c64cc59b7409dd">StopCommunication</a>(devHandle) &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; endl;
    }
    successFlag = <a class="code" href="group___create_destroy.html#g9c42addeed92bb0d642701607b19bbf8">DestroyBioRadio</a>(devHandle);
    cout &lt;&lt; <span class="stringliteral">"Destroy BioRadio Object... ("</span> &lt;&lt; successFlag &lt;&lt; <span class="stringliteral">")\n"</span> &lt;&lt; endl;
  }
  
  system(<span class="stringliteral">"pause"</span>);
  <span class="keywordflow">return</span> 1;
}
<span class="comment">//---------------------------------------------------------------------------</span>
</pre></div> </div>
<hr>
<p>
	<a href="aboutpage.html"><img src="CleveMedLogo.png" alt="CleveMed" align="right" border="0"></a>
	&nbsp; &nbsp;
	<small>&#169; Cleveland Medical Devices Inc. 1999-2007</small>
</p>
